{"version":3,"sources":["app/views/Cell.css","app/views/Grid.css","index.css","app/views/App.css","app/views/Entity.css","app/types/instructions/baseInstruction.ts","app/util/api.ts","app/util/arrays.ts","app/util/numbers.ts","app/util/camera.ts","app/types/dimension.ts","app/types/mazeData.ts","app/types/cell.ts","app/types/maze.ts","app/types/loadable.ts","app/types/id.ts","app/types/entities/player.ts","app/types/entities/entity.ts","app/types/entities/blindGuardian.ts","app/types/entities/exit.ts","app/types/point.ts","app/types/step.ts","app/types/game/entityData.ts","app/types/game/gameData.ts","app/types/instructions/move.ts","app/types/direction.ts","app/types/instructions/update.ts","app/types/instructions/instruction.ts","app/actions.ts","app/types/result.ts","app/types/maybe.ts","app/selectors.ts","app/views/Entity.tsx","app/views/Cell.tsx","app/views/Grid.tsx","app/views/GamePad.tsx","app/views/KeyPad.tsx","app/views/Game.tsx","app/views/App.tsx","app/state.ts","app/reducer.ts","app/sagas/stepEngine.ts","app/sagas/movePlayer.ts","app/sagas/newGame.ts","app/saga.ts","index.tsx","app/store.ts","app/views/GamePad.css"],"names":["module","exports","InstructionType","API_ROOT","maze","dimension","Dimension","create","algorithm","request","fetch","method","mode","headers","body","JSON","stringify","dimensions","then","response","text","base64","MazeData","fromApi","nOf","n","t","Array","fill","sorted","unsorted","sortFn","sort","nonNull","array","filter","randomItem","Math","floor","random","length","randomInRange","start","end","centerOnPoint","grid","point","radius","xMin","x","xMax","yMin","y","yMax","windowedGrid","row","push","Maybe","map","width","height","area","d","randomPoint","Point","fromIndex","pointAlongEdge","northOrSouth","Numbers","bytes","Uint8Array","from","atob","c","charCodeAt","fromByte","byte","walls","s","e","w","fromMazeData","r","Cell","canWalk","direction","Direction","NORTH","EAST","SOUTH","WEST","isLoading","l","state","isLoaded","isErrored","loading","loaded","data","errored","f","v4","name","position","id","ID","type","getColor","getDisplayName","generateAiInstructions","gameData","BlindGuardian","next","heading","options","all","Maze","adjacent","inverse","includes","Arrays","Instruction","Update","Move","toIndex","idx","neighbor","p","neighbors","equals","a","b","instructions","fromEntities","entities","entityMap","reduce","m","positionMap","playerEntityId","find","typeMap","entitiesAtPoint","moveEntity","entity","oldIdx","newIdx","newEntity","eId","updateEntity","updated","entitiesCrossed","last","lastA","lastB","nextA","nextB","neighborsCrossedByEntity","concat","entityData","displayGrid","rows","rowIdx","cells","cell","cellIdx","occupants","EntityData","generateAllAIInstructions","Object","keys","k","i","Entity","entityId","MOVE","payload","validate","move","Result","ok","undefined","err","apply","UPDATE","update","instruction","validateAll","validated","isOk","console","warn","error","applyAll","applied","ActionTypes","msg","isErr","of","value","none","withDefault","maybe","default_","ifPresent","getState","getGame","createSelector","game","getDisplayGrid","Loadable","GameData","getIsProcessingStep","stepId","getPlayer","getWindowedDisplayGrid","player","Camera","className","styles","root","style","backgroundColor","EntityT","drawSide","wall","borderTop","borderRight","borderBottom","borderLeft","o","EmptyCell","classNames","empty","Grid","key","maybeCell","GamePad","onMove","block","button","onClick","KeyPad","handleKeyDown","event","props","disabled","window","addEventListener","this","removeEventListener","React","Game","processingUpdates","requestNewGame","REQUEST_NEW_GAME","startNewGame","START_NEW_GAME","abortStep","ABORT_STEP","completeStep","COMPLETE_STEP","connect","dispatch","MOVE_PLAYER","init","requestingNewGame","newGame","requestStep","ifGameIsLoaded","abortSTep","reducer","State","action","REQUEST_STEP","step","stepEngine","processCollisions","take","select","call","stepValidation","put","aiInstructions","collisions","confirm","location","reload","movePlayer","takeEvery","Step","Api","mazeOptions","startingEntities","Player","exit","Exit","guardians","_","sagas","spawn","ReactDOM","render","store","sagaMiddleware","createSagaMiddleware","createStore","applyMiddleware","run","Saga","configureStore","app","document","getElementById"],"mappings":"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","file":"static/js/main.463a2478.chunk.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\"root\":\"Cell_root__2ti8K\",\"empty\":\"Cell_empty__1ByI9\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"root\":\"Grid_root__xSU_B\",\"row\":\"Grid_row__1rWaL\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"app\":\"index_app__2lpzC\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"root\":\"App_root__ZxxJN\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"root\":\"Entity_root__MaGTf\"};","import { ID } from \"..\";\n\nexport interface BaseInstruction {\n  entityId: ID.ID;\n  type: InstructionType;\n}\n\nexport enum InstructionType {\n  MOVE = \"MOVE\",\n  UPDATE = \"UPDATE\"\n}\n","import { Dimension, MazeData } from \"../types\";\n\nconst API_ROOT = \"https://fv9o21r19a.execute-api.us-east-1.amazonaws.com/dev\";\n\nexport const maze = ({\n  dimension = Dimension.create(10, 10),\n  algorithm = \"aldous-broder\"\n}: MazeData.Options = {}): Promise<MazeData.MazeData> => {\n  const request = fetch(`${API_ROOT}`, {\n    method: \"post\",\n    mode: \"cors\",\n    headers: { \"content-type\": \"application/json\" },\n    body: JSON.stringify({ dimensions: dimension, algorithm })\n  });\n  return request\n    .then(response => response.text())\n    .then(base64 => MazeData.fromApi(dimension, base64));\n};\n","import { Maybe } from \"../types\";\n\nexport const nOf = <T>(n: number, t: T): Array<T> => new Array(n).fill(t);\n\nexport const sorted = <T>(\n  unsorted: Array<T>,\n  sortFn?: (a: T, b: T) => number\n): Array<T> => {\n  const sorted = [...unsorted];\n  sorted.sort(sortFn);\n  return sorted;\n};\n\nexport const nonNull = <T>(array: Array<Maybe.Maybe<T>>): Array<T> =>\n  array.filter(t => t != null) as Array<T>;\n\nexport const randomItem = <T>(array: Array<T>): T =>\n  array[Math.floor(Math.random() * array.length)];\n","export const randomInRange = (start: number, end: number) => {\n  return start + Math.floor(Math.random() * (end - start - 1));\n};\n","import { DisplayGrid, CellAndOccupants } from \"../types/game/gameData\";\nimport { Point, Maybe } from \"../types\";\n\nexport type WindowedGrid = Array<Array<Maybe.Maybe<CellAndOccupants>>>;\n\nexport const centerOnPoint = (\n  grid: DisplayGrid,\n  point: Point.Point,\n  radius: number\n): WindowedGrid => {\n  const xMin = point.x - radius;\n  const xMax = point.x + radius + 1;\n  const yMin = point.y - radius;\n  const yMax = point.y + radius + 1;\n\n  const windowedGrid: WindowedGrid = [];\n\n  for (let y = yMin; y < yMax; y++) {\n    const row = [];\n    for (let x = xMin; x < xMax; x++) {\n      row.push(Maybe.map(row => row[x], grid[y]));\n    }\n    windowedGrid.push(row);\n  }\n\n  return windowedGrid;\n};\n","import { Point } from \".\";\nimport { Numbers } from \"../util\";\n\nexport interface Dimension {\n  width: number;\n  height: number;\n}\n\nexport const create = (width: number = 0, height: number = 0): Dimension => ({\n  width,\n  height\n});\n\nexport const area = (d: Dimension): number => d.width * d.height;\n\nexport const randomPoint = (d: Dimension): Point.Point =>\n  Point.fromIndex(Math.floor(Math.random() * area(d)), d);\n\nexport const pointAlongEdge = (d: Dimension): Point.Point => {\n  const northOrSouth = Math.random() > 0.5;\n\n  return Point.create(\n    northOrSouth\n      ? Numbers.randomInRange(0, d.width)\n      : Math.random() > 0.5\n      ? 0\n      : d.width - 1,\n    !northOrSouth\n      ? Numbers.randomInRange(0, d.height)\n      : Math.random() > 0.5\n      ? 0\n      : d.height - 1\n  );\n};\n","import { Dimension } from \".\";\n\nexport interface MazeData {\n  bytes: Uint8Array;\n  dimension: Dimension.Dimension;\n}\n\nexport interface Options {\n  dimension?: Dimension.Dimension;\n  algorithm?: \"aldous-broder\" | \"binary-tree\" | \"side-winder\";\n}\n\nexport const fromApi = (\n  dimension: Dimension.Dimension,\n  base64: string\n): MazeData => {\n  return {\n    bytes: Uint8Array.from(atob(base64), c => c.charCodeAt(0)),\n    dimension: dimension\n  };\n};\n","import { Direction } from \".\";\n\nexport interface Cell {\n  walls: Walls;\n}\n\n/**\n * A wall is present to direction n if n === true\n */\nexport interface Walls {\n  n: boolean;\n  e: boolean;\n  s: boolean;\n  w: boolean;\n}\n\nexport const walls = ({ n, e, s, w }: Partial<Walls>): Walls => ({\n  n: n || false,\n  e: e || false,\n  s: s || false,\n  w: w || false\n});\n\nexport const fromByte = (byte: number) => ({\n  walls: walls({\n    n: !((byte & 0b00001000) > 0),\n    s: !((byte & 0b00000100) > 0),\n    e: !((byte & 0b00000010) > 0),\n    w: !((byte & 0b00000001) > 0)\n  })\n});\n\nexport const hasWall = (\n  { walls }: Cell,\n  direction: Direction.Direction\n): boolean => {\n  switch (direction) {\n    case Direction.Direction.NORTH:\n      return walls.n;\n    case Direction.Direction.EAST:\n      return walls.e;\n    case Direction.Direction.SOUTH:\n      return walls.s;\n    case Direction.Direction.WEST:\n      return walls.w;\n  }\n};\n","import * as Cell from \"./cell\";\nimport * as MazeData from \"./mazeData\";\nimport { Dimension, Point, Direction } from \".\";\n\nexport interface Maze {\n  readonly grid: Grid;\n  readonly dimension: Dimension.Dimension;\n}\n\nexport type Grid = Array<Array<Cell.Cell>>;\n\nexport const fromMazeData = ({ dimension, bytes }: MazeData.MazeData): Maze => {\n  const grid: Grid = [];\n  for (let r = 0; r < dimension.height; r++) {\n    const row = [];\n    for (let c = 0; c < dimension.width; c++) {\n      row.push(Cell.fromByte(bytes[r * dimension.width + c]));\n    }\n    grid.push(row);\n  }\n\n  return {\n    grid,\n    dimension\n  };\n};\n\nexport const canWalk = (\n  maze: Maze,\n  { x, y }: Point.Point,\n  direction: Direction.Direction\n): boolean => {\n  const cell = maze.grid[y][x];\n  return !Cell.hasWall(cell, direction);\n};\n","interface Loaded<T> {\n  state: \"Loaded\";\n  data: T;\n}\n\ninterface Loading {\n  state: \"Loading\";\n}\n\ninterface Errored {\n  state: \"Errored\";\n  e: any;\n}\n\nexport type Loadable<T> = Loaded<T> | Loading | Errored;\n\nexport const isLoading = <T>(l: Loadable<T>): l is Loading =>\n  l.state === \"Loading\";\n\nexport const isLoaded = <T>(l: Loadable<T>): l is Loaded<T> =>\n  l.state === \"Loaded\";\n\nexport const isErrored = <T>(l: Loadable<T>): l is Errored =>\n  l.state === \"Errored\";\n\nexport const loading = <T>(): Loading => ({ state: \"Loading\" });\n\nexport const loaded = <T>(data: T): Loaded<T> => ({\n  state: \"Loaded\",\n  data\n});\n\nexport const errored = <T>(e: any): Errored => ({ state: \"Errored\", e });\n\nexport const map = <T, R>(f: (t: T) => R, l: Loadable<T>): Loadable<R> =>\n  isLoaded(l) ? loaded(f(l.data)) : l;\n","import { v4 } from \"uuid\";\n\nexport type ID = string;\n\nexport const create = (): ID => v4();\n","import { BaseEntity } from \".\";\nimport { Point, ID } from \"..\";\n\nexport interface Player extends BaseEntity.BaseEntity {\n  type: \"player\";\n  name: string;\n}\n\nexport const create = (\n  name: string,\n  position: Point.Point = Point.create()\n): Player => ({ id: ID.create(), name, position, type: \"player\" });\n","import { GameData } from \"../game\";\nimport { Instruction } from \"..\";\nimport { BlindGuardian, Player, Exit } from \".\";\n\nexport type Entity = Player.Player | BlindGuardian.BlindGuardian | Exit.Exit;\n\nexport const getColor = (e: Entity): string => {\n  switch (e.type) {\n    case \"player\":\n      return \"var(--blue)\";\n    case \"exit\":\n      return \"var(--green)\";\n    default:\n      return \"var(--red)\";\n  }\n};\n\nexport const getDisplayName = (e: Entity): string => {\n  switch (e.type) {\n    case \"player\":\n      return e.name[0];\n    default:\n      return e.type[0];\n  }\n};\n\nexport const generateAiInstructions = (\n  e: Entity,\n  gameData: GameData.GameData\n): Instruction.Instruction[] => {\n  switch (e.type) {\n    case \"blind-guardian\":\n      return BlindGuardian.next(e, gameData);\n    default:\n      return [];\n  }\n};\n","import { BaseEntity } from \".\";\nimport { Point, ID, Direction, Instruction, Maze } from \"..\";\nimport { GameData } from \"../game\";\nimport { Arrays } from \"../../util\";\n\n/**\n * The blind guardian is a sightless, senseless automaton\n */\nexport interface BlindGuardian extends BaseEntity.BaseEntity {\n  type: \"blind-guardian\";\n  heading: Direction.Direction;\n}\n\nexport const create = (\n  position: Point.Point = Point.create()\n): BlindGuardian => ({\n  type: \"blind-guardian\",\n  position,\n  id: ID.create(),\n  heading: Direction.Direction.NORTH\n});\n\nexport const next = (\n  e: BlindGuardian,\n  gameData: GameData.GameData\n): Instruction.Instruction[] => {\n  const options = Direction.all().filter(d =>\n    Maze.canWalk(gameData.maze, e.position, d)\n  );\n\n  const adjacent = options.filter(d => d !== Direction.inverse(e.heading));\n\n  let direction: Direction.Direction;\n\n  if (options.includes(e.heading) && Math.random() > 0.75) {\n    direction = e.heading;\n  } else if (Math.random() > 0.75 && adjacent.length > 0) {\n    direction = Arrays.randomItem(adjacent);\n  } else {\n    direction = options[0];\n  }\n\n  return [\n    Instruction.Update.create({ ...e, heading: direction }),\n    Instruction.Move.create(e.id, direction)\n  ];\n};\n","import { BaseEntity } from \".\";\nimport { Point, ID } from \"..\";\n\nexport interface Exit extends BaseEntity.BaseEntity {\n  type: \"exit\";\n}\n\nexport const create = (position: Point.Point): Exit => ({\n  position,\n  id: ID.create(),\n  type: \"exit\"\n});\n","import { Dimension, Point, Direction } from \".\";\n\nexport interface Point {\n  x: number;\n  y: number;\n}\n\nexport const create = (x: number = 0, y: number = 0): Point => ({ x, y });\n\nexport const toIndex = (\n  { x, y }: Point,\n  { width }: Dimension.Dimension\n): number => y * width + x;\n\nexport const fromIndex = (idx: number, { width }: Dimension.Dimension): Point =>\n  create(Math.floor(idx / width), idx % width);\n\nexport const neighbor = (p: Point, d: Direction.Direction): Point => {\n  switch (d) {\n    case \"NORTH\":\n      return Point.create(p.x, p.y - 1);\n    case \"SOUTH\":\n      return Point.create(p.x, p.y + 1);\n    case \"EAST\":\n      return Point.create(p.x + 1, p.y);\n    case \"WEST\":\n    default:\n      return Point.create(p.x - 1, p.y);\n  }\n};\n\nexport const neighbors = (p: Point, d: Dimension.Dimension): Point[] =>\n  Direction.all()\n    .map(d => neighbor(p, d))\n    .filter(p => p.x >= 0 && p.y >= 0 && p.x < d.width && p.y < d.height);\n\nexport const equals = (a: Point.Point, b: Point.Point): boolean =>\n  a.x === b.x && a.y === b.y;\n","import { Instruction, ID } from \".\";\n\nexport interface Step {\n  instructions: Instruction.Instruction[];\n  id: ID.ID;\n}\n\nexport const create = (...instructions: Instruction.Instruction[]): Step => ({\n  instructions,\n  id: ID.create()\n});\n","import { ID, Dimension, Point, Maybe } from \"..\";\nimport { Entity } from \"../entities\";\n\nexport interface EntityData {\n  entityMap: Record<ID.ID, Entity.Entity>;\n  positionMap: Record<number, ID.ID[]>;\n  playerEntityId: Maybe.Maybe<ID.ID>;\n  typeMap: Record<string, ID.ID[]>;\n}\n\nexport const fromEntities = (\n  entities: Entity.Entity[],\n  dimension: Dimension.Dimension\n): EntityData => ({\n  entityMap: entities.reduce((m: Record<ID.ID, Entity.Entity>, e) => {\n    m[e.id] = e;\n    return m;\n  }, {}),\n  positionMap: entities.reduce((m: Record<number, ID.ID[]>, e) => {\n    const idx = Point.toIndex(e.position, dimension);\n    m[idx] = m[idx] ? [...m[idx], e.id] : [e.id];\n    return m;\n  }, {}),\n  playerEntityId: Maybe.map(\n    p => p.id,\n    entities.find(e => e.type === \"player\")\n  ),\n  typeMap: entities.reduce(\n    (m: Record<string, ID.ID[]>, e) => ({\n      ...m,\n      [e.type]: m[e.id] ? [...m[e.id], e.id] : [e.id]\n    }),\n    {}\n  )\n});\n\nexport const entitiesAtPoint = (\n  data: EntityData,\n  p: Point.Point,\n  d: Dimension.Dimension\n): Entity.Entity[] => {\n  const idx = Point.toIndex(p, d);\n  const ids = data.positionMap[idx] || [];\n  return ids.map(id => data.entityMap[id]);\n};\n\nexport const moveEntity = (\n  id: ID.ID,\n  data: EntityData,\n  p: Point.Point,\n  d: Dimension.Dimension\n): EntityData => {\n  const entity = data.entityMap[id];\n  if (entity != null) {\n    const oldIdx = Point.toIndex(entity.position, d);\n    const newIdx = Point.toIndex(p, d);\n    const newEntity = { ...entity, position: p };\n    return {\n      ...data,\n      entityMap: { ...data.entityMap, [id]: newEntity },\n      positionMap: {\n        ...data.positionMap,\n        [oldIdx]: [\n          ...(data.positionMap[oldIdx] || []).filter(eId => eId !== id)\n        ],\n        [newIdx]: [...(data.positionMap[newIdx] || []), id]\n      }\n    };\n  } else {\n    return data;\n  }\n};\n\n// might need to augment to handle type change\nexport const updateEntity = (\n  updated: Entity.Entity,\n  data: EntityData\n): EntityData => ({\n  ...data,\n  entityMap: { ...data.entityMap, [updated.id]: updated }\n});\n\nexport const entitiesCrossed = (\n  last: EntityData,\n  next: EntityData,\n  a: ID.ID,\n  b: ID.ID\n): boolean => {\n  const lastA = last.entityMap[a];\n  const lastB = last.entityMap[b];\n  const nextA = next.entityMap[a];\n  const nextB = next.entityMap[b];\n\n  return (\n    Point.equals(nextA.position, lastB.position) &&\n    Point.equals(nextB.position, lastA.position)\n  );\n};\n\nexport const neighborsCrossedByEntity = (\n  last: EntityData,\n  next: EntityData,\n  e: ID.ID,\n  d: Dimension.Dimension\n): Entity.Entity[] => {\n  const neighborIndices = Point.neighbors(\n    next.entityMap[e].position,\n    d\n  ).map(p => Point.toIndex(p, d));\n\n  const neighborEntities = neighborIndices.reduce(\n    (entities: ID.ID[], idx) => entities.concat(next.positionMap[idx] || []),\n    []\n  );\n\n  return neighborEntities\n    .filter(id => entitiesCrossed(last, next, e, id))\n    .map(id => next.entityMap[id]);\n};\n","import { Maze, Cell, Point, Instruction } from \"..\";\nimport { EntityData, GameData } from \".\";\nimport { Entity } from \"../entities\";\n\nexport interface GameData {\n  maze: Maze.Maze;\n  entityData: EntityData.EntityData;\n}\n\nexport const create = (\n  maze: Maze.Maze,\n  entityData: EntityData.EntityData\n): GameData => ({\n  maze,\n  entityData\n});\n\nexport interface CellAndOccupants {\n  cell: Cell.Cell;\n  occupants: Entity.Entity[];\n}\n\nexport type DisplayGrid = Array<Array<CellAndOccupants>>;\n\nexport const displayGrid = ({ maze, entityData }: GameData): DisplayGrid =>\n  maze.grid.reduce(\n    (rows: CellAndOccupants[][], row, rowIdx) => [\n      ...rows,\n      row.reduce(\n        (cells: CellAndOccupants[], cell, cellIdx) =>\n          cells.concat({\n            cell,\n            occupants: EntityData.entitiesAtPoint(\n              entityData,\n              Point.create(cellIdx, rowIdx),\n              maze.dimension\n            )\n          }),\n        []\n      )\n    ],\n    []\n  );\n\nexport const generateAllAIInstructions = (\n  gameData: GameData.GameData\n): Instruction.Instruction[] => {\n  const aiEntities = Object.keys(gameData.entityData.entityMap)\n    .map(k => gameData.entityData.entityMap[k])\n    .filter(e => e.type !== \"player\");\n\n  return aiEntities.reduce(\n    (i: Instruction.Instruction[], e) =>\n      i.concat(Entity.generateAiInstructions(e, gameData)),\n    []\n  );\n};\n","import { Direction, ID, Result, Maze, Point } from \"..\";\nimport { GameData, EntityData } from \"../game\";\nimport { BaseInstruction, InstructionType } from \"./baseInstruction\";\n\nexport interface MoveInstruction extends BaseInstruction {\n  type: InstructionType.MOVE;\n  payload: {\n    direction: Direction.Direction;\n  };\n}\n\nexport const create = (\n  entityId: ID.ID,\n  direction: Direction.Direction\n): MoveInstruction => ({\n  type: InstructionType.MOVE,\n  entityId,\n  payload: { direction }\n});\n\nexport const validate = (\n  move: MoveInstruction,\n  gameData: GameData.GameData\n): Result.Result<void> =>\n  Maze.canWalk(\n    gameData.maze,\n    gameData.entityData.entityMap[move.entityId].position,\n    move.payload.direction\n  )\n    ? Result.ok(undefined)\n    : Result.err(\"way is blocked\");\n\nexport const apply = (\n  move: MoveInstruction,\n  gameData: GameData.GameData\n): GameData.GameData => ({\n  ...gameData,\n  entityData: EntityData.moveEntity(\n    move.entityId,\n    gameData.entityData,\n    Point.neighbor(\n      gameData.entityData.entityMap[move.entityId].position,\n      move.payload.direction\n    ),\n    gameData.maze.dimension\n  )\n});\n","export enum Direction {\n  NORTH = \"NORTH\",\n  SOUTH = \"SOUTH\",\n  EAST = \"EAST\",\n  WEST = \"WEST\"\n}\n\nexport const all = (): Direction[] => [\n  Direction.NORTH,\n  Direction.SOUTH,\n  Direction.EAST,\n  Direction.WEST\n];\n\nexport const inverse = (d: Direction): Direction => {\n  switch (d) {\n    case Direction.NORTH:\n      return Direction.SOUTH;\n    case Direction.SOUTH:\n      return Direction.NORTH;\n    case Direction.EAST:\n      return Direction.WEST;\n    case Direction.WEST:\n      return Direction.EAST;\n  }\n};\n","import { BaseInstruction, InstructionType } from \"./baseInstruction\";\nimport { Entity } from \"../entities\";\nimport { GameData, EntityData } from \"../game\";\n\nexport interface UpdateInstruction extends BaseInstruction {\n  type: InstructionType.UPDATE;\n  payload: {\n    updated: Entity.Entity;\n  };\n}\n\nexport const create = (updated: Entity.Entity): UpdateInstruction => ({\n  type: InstructionType.UPDATE,\n  entityId: updated.id,\n  payload: { updated }\n});\n\nexport const apply = (\n  update: UpdateInstruction,\n  gameData: GameData.GameData\n): GameData.GameData => ({\n  ...gameData,\n  entityData: EntityData.updateEntity(\n    update.payload.updated,\n    gameData.entityData\n  )\n});\n","import { Result, Instruction } from \"..\";\nimport { Move, Update } from \".\";\nimport { GameData } from \"../game\";\nimport { MoveInstruction } from \"./move\";\nimport { InstructionType } from \"./baseInstruction\";\nimport { UpdateInstruction } from \"./update\";\n\nexport type Instruction = MoveInstruction | UpdateInstruction;\n\nexport const validate = (\n  instruction: Instruction,\n  gameData: GameData.GameData\n): Result.Result<void> => {\n  switch (instruction.type) {\n    case InstructionType.MOVE:\n      return Move.validate(instruction, gameData);\n    default:\n      return Result.err(`Unkown instruction of type ${instruction.type}`);\n  }\n};\n\nexport const validateAll = (\n  instructions: Instruction[],\n  gameData: GameData.GameData\n): Result.Result<void> =>\n  instructions.reduce(\n    (validated: Result.Result<void>, i) =>\n      Result.isOk(validated) ? validate(i, gameData) : validated,\n    Result.ok(undefined)\n  );\n\nexport const apply = (\n  instruction: Instruction,\n  gameData: GameData.GameData\n): Result.Result<GameData.GameData> => {\n  try {\n    switch (instruction.type) {\n      case InstructionType.MOVE:\n        return Result.ok(Move.apply(instruction, gameData));\n      case InstructionType.UPDATE:\n        return Result.ok(Update.apply(instruction, gameData));\n    }\n  } catch (e) {\n    console.warn(\"Error applying instruction\", instruction);\n    console.error(e);\n    return Result.err(\"Error applying instructions\");\n  }\n};\n\nexport const applyAll = (\n  instructions: Instruction[],\n  gameData: GameData.GameData\n): Result.Result<GameData.GameData> =>\n  instructions.reduce(\n    (applied: Result.Result<GameData.GameData>, i) =>\n      Result.isOk(applied) ? apply(i, applied.data) : applied,\n    Result.ok(gameData)\n  );\n","import { MazeData, Maze, Step, ID, Direction } from \"./types\";\nimport { Entity } from \"./types/entities\";\nimport { GameData } from \"./types/game\";\n\nexport enum ActionTypes {\n  REQUEST_NEW_GAME = \"REQUEST_NEW_GAME\",\n  START_NEW_GAME = \"START_NEW_GAME\",\n\n  REQUEST_STEP = \"REQUEST_STEP\",\n  COMPLETE_STEP = \"COMPLETE_STEP\",\n  ABORT_STEP = \"ABORT_STEP\",\n\n  MOVE_PLAYER = \"MOVE_PLAYER\"\n}\n\ninterface NewGameOptions {\n  mazeOptions?: MazeData.Options;\n}\nexport interface RequestNewGame {\n  type: ActionTypes.REQUEST_NEW_GAME;\n  options: NewGameOptions;\n}\n\nexport interface StartNewGame {\n  type: ActionTypes.START_NEW_GAME;\n  maze: Maze.Maze;\n  entities: Entity.Entity[];\n}\n\nexport interface RequestStep {\n  type: ActionTypes.REQUEST_STEP;\n  step: Step.Step;\n}\n\nexport interface AbortStep {\n  type: ActionTypes.ABORT_STEP;\n  stepId: ID.ID;\n}\n\nexport interface CompleteStep {\n  type: ActionTypes.COMPLETE_STEP;\n  stepId: ID.ID;\n  gameData: GameData.GameData;\n}\n\nexport interface MovePlayer {\n  type: ActionTypes.MOVE_PLAYER;\n  direction: Direction.Direction;\n}\n\nexport type AppAction =\n  | RequestNewGame\n  | StartNewGame\n  | RequestStep\n  | AbortStep\n  | CompleteStep\n  | MovePlayer;\n\nexport const requestNewGame = (\n  options: NewGameOptions = {}\n): RequestNewGame => ({ type: ActionTypes.REQUEST_NEW_GAME, options });\n\nexport const startNewGame = (\n  maze: Maze.Maze,\n  entities: Entity.Entity[]\n): StartNewGame => ({\n  type: ActionTypes.START_NEW_GAME,\n  maze,\n  entities\n});\n\nexport const requestStep = (step: Step.Step): RequestStep => ({\n  type: ActionTypes.REQUEST_STEP,\n  step\n});\n\nexport const abortStep = (stepId: ID.ID): AbortStep => ({\n  type: ActionTypes.ABORT_STEP,\n  stepId\n});\n\nexport const completeStep = (\n  stepId: ID.ID,\n  gameData: GameData.GameData\n): CompleteStep => ({\n  type: ActionTypes.COMPLETE_STEP,\n  stepId,\n  gameData\n});\n\nexport const movePlayer = (direction: Direction.Direction): MovePlayer => ({\n  type: ActionTypes.MOVE_PLAYER,\n  direction\n});\n","export interface Err {\n  type: \"Error\";\n  msg: string;\n}\n\nexport interface Ok<T> {\n  type: \"Ok\";\n  data: T;\n}\n\nexport type Result<T> = Ok<T> | Err;\n\nexport const ok = <T>(data: T): Ok<T> => ({ type: \"Ok\", data });\n\nexport const err = (msg: string): Err => ({ type: \"Error\", msg });\n\nexport const isErr = <T>(r: Result<T>): r is Err => r.type === \"Error\";\n\nexport const isOk = <T>(r: Result<T>): r is Ok<T> => r.type === \"Ok\";\n\nexport const map = <T, R>(f: (t: T) => R, r: Result<T>): Result<R> =>\n  isOk(r) ? ok(f(r.data)) : r;\n","export type Maybe<T> = T | undefined | null;\n\nexport const of = <T>(value: T | undefined | null): Maybe<T> => value;\nexport const none = <T>(): Maybe<T> => undefined;\nexport const withDefault = <T>(maybe: Maybe<T>, default_: T): T =>\n  maybe != null ? maybe : default_;\nexport const map = <T, R>(f: (t: T) => R, maybe: Maybe<T>): Maybe<R> =>\n  maybe != null ? f(maybe) : undefined;\n\nexport const ifPresent = <T>(f: (t: T) => void, maybe: Maybe<T>): void => {\n  if (maybe) {\n    f(maybe);\n  }\n};\n","import { State } from \"./state\";\nimport { createSelector } from \"reselect\";\nimport { Loadable, Maybe } from \"./types\";\nimport { GameData } from \"./types/game\";\nimport { Camera } from \"./util\";\n\nexport const getState = (state: State): State => state;\n\nexport const getGame = createSelector(getState, state => state.game);\n\nexport const getDisplayGrid = createSelector(getGame, game =>\n  Loadable.map(GameData.displayGrid, game)\n);\n\nexport const getIsProcessingStep = createSelector(\n  getState,\n  state => state.stepId != null\n);\n\nexport const getPlayer = createSelector(getGame, game =>\n  Loadable.isLoaded(game)\n    ? Maybe.map(\n        id => game.data.entityData.entityMap[id],\n        game.data.entityData.playerEntityId\n      )\n    : undefined\n);\n\nexport const getWindowedDisplayGrid = createSelector(\n  getDisplayGrid,\n  getPlayer,\n  (displayGrid, player) =>\n    Loadable.map(\n      grid =>\n        player != null ? Camera.centerOnPoint(grid, player.position, 3) : [],\n      displayGrid\n    )\n);\n","import React from \"react\";\nimport { Entity as EntityT } from \"../types/entities\";\nimport styles from \"./Entity.css\";\n\nexport const Entity = (entity: EntityT.Entity): JSX.Element => (\n  <div\n    className={styles.root}\n    style={{ backgroundColor: EntityT.getColor(entity) }}\n  >\n    {EntityT.getDisplayName(entity)}\n  </div>\n);\n","import React from \"react\";\nimport { Cell as CellT, Maybe } from \"../types\";\nimport styles from \"./Cell.css\";\nimport { Entity as EntityT } from \"../types/entities\";\nimport { Entity } from \"./Entity\";\nimport classNames from \"classnames\";\n\ninterface Props {\n  cell: CellT.Cell;\n  occupants: EntityT.Entity[];\n}\n\nconst IS_WALL = \"0.5px solid black\";\nconst IS_OPEN = \"0.5px transparent\";\nconst drawSide = (wall: boolean) => (wall ? IS_WALL : IS_OPEN);\n\nexport const Cell = ({ cell, occupants }: Props): JSX.Element => {\n  const { walls } = cell;\n  return (\n    <div\n      className={styles.root}\n      style={{\n        borderTop: drawSide(walls.n),\n        borderRight: drawSide(walls.e),\n        borderBottom: drawSide(walls.s),\n        borderLeft: drawSide(walls.w)\n      }}\n    >\n      {Maybe.map(\n        o => (\n          <Entity {...o} />\n        ),\n        occupants[0]\n      )}\n    </div>\n  );\n};\n\nexport const EmptyCell = () => (\n  <div className={classNames(styles.empty, styles.root)}></div>\n);\n","import React from \"react\";\nimport { Cell, EmptyCell } from \"./Cell\";\nimport styles from \"./Grid.css\";\nimport { Camera } from \"../util\";\nimport { Maybe } from \"../types\";\n\ninterface Props {\n  grid: Camera.WindowedGrid;\n}\n\nexport const Grid = ({ grid }: Props): JSX.Element => {\n  return (\n    <div className={styles.root}>\n      {grid.map((row, idx) => (\n        <div key={idx} className={styles.row}>\n          {row.map((maybeCell, idx) =>\n            Maybe.withDefault(\n              Maybe.map(\n                cell => (\n                  <Cell key={idx} cell={cell.cell} occupants={cell.occupants} />\n                ),\n                maybeCell\n              ),\n              <EmptyCell />\n            )\n          )}\n        </div>\n      ))}\n    </div>\n  );\n};\n","import React from \"react\";\nimport { Effect, Direction } from \"../types\";\nimport styles from \"./GamePad.css\";\nimport classNames from \"classnames\";\n\ninterface DispatchProps {\n  onMove: Effect.Effect1<Direction.Direction>;\n}\n\ntype Props = DispatchProps;\n\nexport const GamePad = ({ onMove }: Props): JSX.Element => (\n  <div className={styles.root}>\n    <div className={styles.row}>\n      <div className={styles.block}></div>\n      <button\n        className={classNames(styles.block, styles.button)}\n        onClick={() => onMove(Direction.Direction.NORTH)}\n      ></button>\n      <div className={styles.block}></div>\n    </div>\n    <div className={styles.row}>\n      <button\n        className={classNames(styles.block, styles.button)}\n        onClick={() => onMove(Direction.Direction.WEST)}\n      ></button>\n      <div className={styles.block}></div>\n      <button\n        className={classNames(styles.block, styles.button)}\n        onClick={() => onMove(Direction.Direction.EAST)}\n      ></button>\n    </div>\n    <div className={styles.row}>\n      <div className={styles.block}></div>\n      <button\n        className={classNames(styles.block, styles.button)}\n        onClick={() => onMove(Direction.Direction.SOUTH)}\n      ></button>\n      <div className={styles.block}></div>\n    </div>\n  </div>\n);\n","import * as React from \"react\";\nimport { Effect, Direction } from \"../types\";\n\ninterface Props {\n  onMove: Effect.Effect1<Direction.Direction>;\n  disabled: boolean;\n}\n\nexport class KeyPad extends React.PureComponent<Props> {\n  componentDidMount() {\n    window.addEventListener(\"keydown\", this.handleKeyDown);\n  }\n\n  componentWillUnmount() {\n    window.removeEventListener(\"keydown\", this.handleKeyDown);\n  }\n\n  render() {\n    return <></>;\n  }\n\n  private handleKeyDown = (event: KeyboardEvent) => {\n    if (!this.props.disabled) {\n      if (event.key === \"ArrowUp\" || event.key === \"w\") {\n        this.props.onMove(Direction.Direction.NORTH);\n      } else if (event.key === \"ArrowRight\" || event.key === \"d\") {\n        this.props.onMove(Direction.Direction.EAST);\n      } else if (event.key === \"ArrowDown\" || event.key === \"d\") {\n        this.props.onMove(Direction.Direction.SOUTH);\n      } else if (event.key === \"ArrowLeft\" || event.key === \"a\") {\n        this.props.onMove(Direction.Direction.WEST);\n      }\n    }\n  };\n}\n","import * as React from \"react\";\nimport { Grid } from \"./Grid\";\nimport { GamePad } from \"./GamePad\";\nimport { Effect, Direction } from \"../types\";\nimport { KeyPad } from \"./KeyPad\";\nimport { Camera } from \"../util\";\n\ninterface Props {\n  grid: Camera.WindowedGrid;\n  onMove: Effect.Effect1<Direction.Direction>;\n  processingUpdates: boolean;\n}\n\nexport const Game = ({\n  grid,\n  onMove,\n  processingUpdates\n}: Props): JSX.Element => (\n  <>\n    <Grid grid={grid} />\n    <GamePad onMove={onMove} />\n    <KeyPad onMove={onMove} disabled={processingUpdates} />\n  </>\n);\n","import React, { Dispatch } from \"react\";\nimport styles from \"./App.css\";\nimport { connect } from \"react-redux\";\nimport { State } from \"../state\";\nimport { Loadable, Effect, Direction } from \"../types\";\nimport { getIsProcessingStep, getWindowedDisplayGrid } from \"../selectors\";\nimport { Game } from \"./Game\";\nimport { AppAction, movePlayer } from \"../actions\";\nimport { WindowedGrid } from \"../util/camera\";\n\ninterface StateProps {\n  grid: Loadable.Loadable<WindowedGrid>;\n  processingUpdates: boolean;\n}\n\ninterface DispatchProps {\n  onMove: Effect.Effect1<Direction.Direction>;\n}\n\ntype Props = StateProps & DispatchProps;\n\nconst App = ({ grid, processingUpdates, onMove }: Props) => {\n  return (\n    <div className={styles.root}>\n      {Loadable.isLoading(grid) && <span>Loading . . . </span>}\n      {Loadable.isLoaded(grid) && grid.data && (\n        <Game\n          processingUpdates={processingUpdates}\n          grid={grid.data}\n          onMove={onMove}\n        />\n      )}\n    </div>\n  );\n};\n\nexport const mapStateToProps = (state: State): StateProps => ({\n  grid: getWindowedDisplayGrid(state),\n  processingUpdates: getIsProcessingStep(state)\n});\n\nexport const mapDispatchToProps = (\n  dispatch: Dispatch<AppAction>\n): DispatchProps => ({\n  onMove: d => dispatch(movePlayer(d))\n});\n\nexport default connect(mapStateToProps, mapDispatchToProps)(App);\n","import { Maze, ID } from \"./types\";\nimport { Loadable } from \"./types\";\nimport { GameData, EntityData } from \"./types/game\";\nimport { Entity } from \"./types/entities\";\n\nexport interface State {\n  game: Loadable.Loadable<GameData.GameData>;\n  stepId?: ID.ID;\n}\n\nexport const create = (init = {}): State => ({\n  game: Loadable.loading(),\n  ...init\n});\n\nexport const requestingNewGame = (state: State): State => ({\n  ...state,\n  game: Loadable.loading()\n});\n\nexport const newGame = (\n  state: State,\n  maze: Maze.Maze,\n  entities: Entity.Entity[]\n): State => ({\n  ...state,\n  game: Loadable.loaded(\n    GameData.create(maze, EntityData.fromEntities(entities, maze.dimension))\n  )\n});\n\nexport const ifGameIsLoaded = (f: () => State, state: State): State =>\n  Loadable.isLoaded(state.game) ? f() : state;\n\nexport const requestStep = (state: State, stepId: ID.ID): State => ({\n  ...state,\n  stepId\n});\n\nexport const completeStep = (\n  state: State,\n  stepId: ID.ID,\n  gameData: GameData.GameData\n): State =>\n  ifGameIsLoaded(\n    () =>\n      state.stepId === stepId\n        ? {\n            ...state,\n            stepId: undefined,\n            game: Loadable.loaded(gameData)\n          }\n        : state,\n    state\n  );\n\nexport const abortSTep = (state: State, stepId: ID.ID) =>\n  state.stepId === stepId ? { ...state, stepId: undefined } : state;\n","import * as State from \"./state\";\nimport { AppAction, ActionTypes } from \"./actions\";\n\nexport const reducer = (\n  state: State.State = State.create(),\n  action: AppAction\n): State.State => {\n  switch (action.type) {\n    case ActionTypes.REQUEST_STEP:\n      return State.requestStep(state, action.step.id);\n    case ActionTypes.COMPLETE_STEP:\n      return State.completeStep(state, action.stepId, action.gameData);\n    case ActionTypes.ABORT_STEP:\n      return State.abortSTep(state, action.stepId);\n    case ActionTypes.START_NEW_GAME:\n      return State.newGame(state, action.maze, action.entities);\n    case ActionTypes.REQUEST_NEW_GAME:\n      return State.requestingNewGame(state);\n    default:\n      return state;\n  }\n};\n","import { RequestStep, abortStep, completeStep, ActionTypes } from \"../actions\";\nimport { Loadable, Instruction, Result } from \"../types\";\nimport { GameData, EntityData } from \"../types/game\";\nimport { select, put, take, call } from \"redux-saga/effects\";\nimport { getGame } from \"../selectors\";\n\nexport function* stepEngine() {\n  while (true) {\n    try {\n      const { step }: RequestStep = yield take(ActionTypes.REQUEST_STEP);\n      const game: Loadable.Loadable<GameData.GameData> = yield select(getGame);\n      if (Loadable.isLoaded(game)) {\n        const { data: gameData } = game;\n\n        const stepValidation: Result.Result<void> = yield call(\n          Instruction.validateAll,\n          step.instructions,\n          gameData\n        );\n\n        if (Result.isErr(stepValidation)) {\n          yield put(abortStep(step.id));\n          continue;\n        }\n\n        const aiInstructions = GameData.generateAllAIInstructions(gameData);\n        const instructions = [...aiInstructions, ...step.instructions];\n\n        const applied: Result.Result<GameData.GameData> = yield call(\n          Instruction.applyAll,\n          instructions,\n          gameData\n        );\n\n        if (Result.isErr(applied)) {\n          yield put(abortStep(step.id));\n          continue;\n        }\n\n        yield put(completeStep(step.id, applied.data));\n\n        // player collisions POC:\n        yield call(processCollisions, gameData, applied.data);\n      }\n    } catch (e) {\n      console.warn(\"Error processing step\");\n      console.error(e);\n    }\n  }\n}\n\nexport function* processCollisions(\n  last: GameData.GameData,\n  next: GameData.GameData\n) {\n  const player = next.entityData.entityMap[next.entityData.playerEntityId!];\n  const collisions = EntityData.entitiesAtPoint(\n    next.entityData,\n    player.position,\n    next.maze.dimension\n  )\n    .filter(e => e.id !== player.id)\n    .concat(\n      EntityData.neighborsCrossedByEntity(\n        last.entityData,\n        next.entityData,\n        player.id,\n        next.maze.dimension\n      )\n    );\n\n  if (collisions.length === 0) {\n    return;\n  } else if (collisions.find(e => e.type === \"blind-guardian\")) {\n    yield call(window.confirm, \"You've been annihilated.\");\n    window.location.reload();\n  } else if (collisions.find(e => e.type === \"exit\")) {\n    yield call(window.confirm, \"You have escaped with your life. . . for now.\");\n    window.location.reload();\n  }\n}\n","import { takeEvery, select, put } from \"redux-saga/effects\";\nimport { ActionTypes, MovePlayer, requestStep } from \"../actions\";\nimport { Player } from \"../types/entities\";\nimport { getPlayer, getIsProcessingStep } from \"../selectors\";\nimport { Step, Instruction } from \"../types\";\n\nexport function* movePlayer() {\n  yield takeEvery(ActionTypes.MOVE_PLAYER, function*(action: MovePlayer) {\n    const player: Player.Player = yield select(getPlayer);\n    const isProcessing: boolean = yield select(getIsProcessingStep);\n\n    if (!isProcessing && !!player) {\n      yield put(\n        requestStep(\n          Step.create(Instruction.Move.create(player.id, action.direction))\n        )\n      );\n    }\n  });\n}\n","import { RequestNewGame, ActionTypes, startNewGame } from \"../actions\";\nimport { Maze, Dimension, MazeData } from \"../types\";\nimport { call, take, put } from \"redux-saga/effects\";\nimport { Api, Numbers } from \"../util\";\nimport { Player, BlindGuardian, Entity, Exit } from \"../types/entities\";\n\nexport function* newGame() {\n  while (true) {\n    try {\n      const { options }: RequestNewGame = yield take(\n        ActionTypes.REQUEST_NEW_GAME\n      );\n      const data: MazeData.MazeData = yield call(\n        Api.maze,\n        options.mazeOptions || {}\n      );\n      const maze: Maze.Maze = Maze.fromMazeData(data);\n\n      yield put(startNewGame(maze, startingEntities(maze)));\n    } catch (e) {\n      console.warn(\"Error initializing new game\");\n      console.error(e);\n    }\n  }\n}\n\nexport const startingEntities = ({ dimension }: Maze.Maze): Entity.Entity[] => {\n  const player = Player.create(\"Test\", Dimension.pointAlongEdge(dimension));\n  const exit = Exit.create(Dimension.randomPoint(dimension));\n  const guardians = new Array(Numbers.randomInRange(1, 5))\n    .fill(undefined)\n    .map(_ => BlindGuardian.create(Dimension.randomPoint(dimension)));\n\n  return [player, exit, ...guardians];\n};\n","import { spawn, all, put } from \"redux-saga/effects\";\nimport { Dimension } from \"./types\";\nimport { requestNewGame } from \"./actions\";\nimport { stepEngine } from \"./sagas/stepEngine\";\nimport { movePlayer } from \"./sagas/movePlayer\";\nimport { newGame } from \"./sagas/newGame\";\n\nconst sagas = [newGame, stepEngine, movePlayer];\n\nexport function* root() {\n  yield all(sagas.map(s => spawn(s)));\n  yield put(\n    requestNewGame({\n      mazeOptions: {\n        dimension: Dimension.create(15, 15),\n        algorithm: \"aldous-broder\"\n      }\n    })\n  );\n}\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport styles from \"./index.css\";\nimport App from \"./app/views/App\";\nimport { Provider } from \"react-redux\";\nimport { configureStore } from \"./app/store\";\n\nReactDOM.render(\n  <Provider store={configureStore()}>\n    <div className={styles.app}>\n      <App />\n    </div>\n  </Provider>,\n  document.getElementById(\"root\")\n);\n","import { createStore, applyMiddleware, Store } from \"redux\";\nimport { reducer } from \"./reducer\";\nimport createSagaMiddleware from \"redux-saga\";\nimport * as Saga from \"./saga\";\nimport { State } from \"./state\";\nimport { AppAction } from \"./actions\";\n\nexport const configureStore = (): Store<State, AppAction> => {\n  const sagaMiddleware = createSagaMiddleware();\n  const store = createStore(reducer, applyMiddleware(sagaMiddleware));\n\n  sagaMiddleware.run(Saga.root);\n\n  return store;\n};\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"root\":\"GamePad_root__Lay6t\",\"row\":\"GamePad_row__164Sm\",\"block\":\"GamePad_block__l2_xd\",\"button\":\"GamePad_button__3kDFo\"};"],"sourceRoot":""}