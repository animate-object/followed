(this.webpackJsonpfollowed=this.webpackJsonpfollowed||[]).push([[0],{16:function(n,t,e){n.exports={root:"Cell_root__2ti8K",empty:"Cell_empty__1ByI9",seen:"Cell_seen__2qSTX",visible:"Cell_visible__2bnT3",unknown:"Cell_unknown__2tYkG"}},24:function(n,t,e){n.exports={root:"Grid_root__xSU_B",row:"Grid_row__1rWaL"}},28:function(n,t){},29:function(n,t,e){n.exports={app:"index_app__2lpzC"}},30:function(n,t,e){n.exports={root:"App_root__ZxxJN"}},33:function(n,t,e){n.exports={root:"Entity_root__MaGTf"}},40:function(n,t,e){n.exports=e(53)},53:function(n,t,e){"use strict";e.r(t);var r={};e.r(r),e.d(r,"maze",(function(){return W}));var a={};e.r(a),e.d(a,"nOf",(function(){return z})),e.d(a,"sorted",(function(){return G})),e.d(a,"nonNull",(function(){return Y})),e.d(a,"randomItem",(function(){return B}));var i={};e.r(i),e.d(i,"randomInRange",(function(){return Q}));var o={};e.r(o),e.d(o,"centerOnPoint",(function(){return V}));var c={};e.r(c),e.d(c,"getSiteSetting",(function(){return F}));var u={};e.r(u),e.d(u,"parseQuery",(function(){return J}));var d={};e.r(d),e.d(d,"create",(function(){return X})),e.d(d,"area",(function(){return Z})),e.d(d,"randomPoint",(function(){return $})),e.d(d,"pointAlongEdge",(function(){return nn})),e.d(d,"inBounds",(function(){return tn}));var s={};e.r(s),e.d(s,"fromApi",(function(){return en}));var f={};e.r(f),e.d(f,"fromMazeData",(function(){return an})),e.d(f,"canWalk",(function(){return on})),e.d(f,"canTravel",(function(){return cn})),e.d(f,"lookInDirection",(function(){return un})),e.d(f,"peekableCorners",(function(){return dn})),e.d(f,"seenFromPoint",(function(){return sn}));var l={};e.r(l),e.d(l,"isLoading",(function(){return fn})),e.d(l,"isLoaded",(function(){return ln})),e.d(l,"isErrored",(function(){return pn})),e.d(l,"loading",(function(){return mn})),e.d(l,"loaded",(function(){return yn})),e.d(l,"errored",(function(){return vn})),e.d(l,"map",(function(){return En}));var p={};e.r(p),e.d(p,"create",(function(){return hn}));var m={};e.r(m),e.d(m,"create",(function(){return gn})),e.d(m,"randomDisplayName",(function(){return On}));var y={};e.r(y),e.d(y,"EntityClass",(function(){return M}));var v={};e.r(v),e.d(v,"getColor",(function(){return Tn})),e.d(v,"getDisplayName",(function(){return Sn})),e.d(v,"getDescription",(function(){return xn})),e.d(v,"generateAiInstructions",(function(){return kn})),e.d(v,"getKillMessage",(function(){return An}));var E={};e.r(E),e.d(E,"create",(function(){return Mn})),e.d(E,"next",(function(){return jn})),e.d(E,"DISPLAY",(function(){return _n}));var b={};e.r(b),e.d(b,"fromEntities",(function(){return In})),e.d(b,"entitiesAtPoint",(function(){return Dn})),e.d(b,"getPlayer",(function(){return Pn})),e.d(b,"moveEntity",(function(){return Nn})),e.d(b,"updateEntity",(function(){return Rn})),e.d(b,"entitiesCrossed",(function(){return Ln})),e.d(b,"neighborsCrossedByEntity",(function(){return Cn}));var h={};e.r(h),e.d(h,"create",(function(){return Un})),e.d(h,"displayGrid",(function(){return Wn})),e.d(h,"generateAllAIInstructions",(function(){return Hn}));var g={};e.r(g),e.d(g,"create",(function(){return zn})),e.d(g,"next",(function(){return Gn})),e.d(g,"wander",(function(){return Yn})),e.d(g,"lookForPlayerInDirection",(function(){return Bn})),e.d(g,"DISPLAY",(function(){return Qn}));var O={};e.r(O),e.d(O,"create",(function(){return Vn})),e.d(O,"DISPLAY",(function(){return Fn}));var w={};e.r(w),e.d(w,"create",(function(){return Kn})),e.d(w,"toIndex",(function(){return qn})),e.d(w,"fromIndex",(function(){return Jn})),e.d(w,"neighbor",(function(){return Xn})),e.d(w,"neighbors",(function(){return Zn})),e.d(w,"diagonalNeighbors",(function(){return $n})),e.d(w,"equals",(function(){return nt}));var T={};e.r(T),e.d(T,"create",(function(){return tt}));var S={};e.r(S),e.d(S,"move",(function(){return rt})),e.d(S,"update",(function(){return it})),e.d(S,"wait",(function(){return ot})),e.d(S,"validate",(function(){return ct})),e.d(S,"validateAll",(function(){return ut})),e.d(S,"apply",(function(){return dt})),e.d(S,"applyAll",(function(){return st}));var x={};e.r(x),e.d(x,"Direction",(function(){return et})),e.d(x,"all",(function(){return lt})),e.d(x,"inverse",(function(){return pt})),e.d(x,"random",(function(){return mt}));var k={};e.r(k),e.d(k,"ok",(function(){return yt})),e.d(k,"err",(function(){return vt})),e.d(k,"isErr",(function(){return Et})),e.d(k,"isOk",(function(){return bt})),e.d(k,"map",(function(){return ht}));var A={};e.r(A),e.d(A,"of",(function(){return gt})),e.d(A,"none",(function(){return Ot})),e.d(A,"withDefault",(function(){return wt})),e.d(A,"map",(function(){return Tt})),e.d(A,"ifPresent",(function(){return St}));var M,j=e(1),_=e.n(j),I=e(19),D=e.n(I),P=e(29),N=e.n(P),R=e(30),L=e.n(R),C=e(17),U="https://fv9o21r19a.execute-api.us-east-1.amazonaws.com/dev",W=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=n.dimension,e=void 0===t?d.create(10,10):t,r=n.algorithm,a=void 0===r?"aldous-broder":r,i=fetch("".concat(U),{method:"post",mode:"cors",headers:{"content-type":"application/json"},body:JSON.stringify({dimensions:e,algorithm:a})});return i.then((function(n){return n.text()})).then((function(n){return s.fromApi(e,a,n)}))},H=e(6),z=function(n,t){return new Array(n).fill(t)},G=function(n,t){var e=Object(H.a)(n);return e.sort(t),e},Y=function(n){return n.filter((function(n){return null!=n}))},B=function(n){return n[Math.floor(Math.random()*n.length)]},Q=function(n,t){return n+Math.floor(Math.random()*(t-n-1))},V=function(n,t,e){for(var r=t.x-e,a=t.x+e+1,i=t.y-e,o=t.y+e+1,c=[],u=i;u<o;u++){for(var d=[],s=function(t){d.push(A.map((function(n){return n[t]}),n[u]))},f=r;f<a;f++)s(f);c.push(d)}return c},F=function(n,t){return A.withDefault(window.localStorage.getItem("".concat("followed.settings",".").concat(n)),(function(){var e=t();if(e)return window.localStorage.setItem("".concat("followed.settings",".").concat(n),e),e}))},K=e(10),q=e(4),J=function(){return window.location.search.substring(1).split("&").reduce((function(n,t){var e=t.split("=");return Object(q.a)({},n,Object(K.a)({},e[0],e[1]))}),{})},X=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return{width:n,height:t}},Z=function(n){return n.width*n.height},$=function(n){return w.fromIndex(Math.floor(Math.random()*Z(n)),n)},nn=function(n){var t=Math.random()>.5;return w.create(t?i.randomInRange(0,n.width):Math.random()>.5?0:n.width-1,t?Math.random()>.5?0:n.height-1:i.randomInRange(0,n.height))},tn=function(n,t){return t.x>=0&&t.y>=0&&t.x<n.width&&t.y<n.height},en=function(n,t,e){return{bytes:Uint8Array.from(atob(e),(function(n){return n.charCodeAt(0)})),dimension:n,algorithm:t}},rn=function(n){return{walls:(t={n:!((8&n)>0),s:!((4&n)>0),e:!((2&n)>0),w:!((1&n)>0)},{n:t.n||!1,e:t.e||!1,s:t.s||!1,w:t.w||!1})};var t},an=function(n){for(var t=n.dimension,e=n.bytes,r=n.algorithm,a=[],i=0;i<t.height;i++){for(var o=[],c=0;c<t.width;c++)o.push(rn(e[i*t.width+c]));a.push(o)}return{grid:a,dimension:t,algorithm:r}},on=function(n,t,e){var r=t.x,a=t.y;return!function(n,t){var e=n.walls;switch(t){case x.Direction.NORTH:return e.n;case x.Direction.EAST:return e.e;case x.Direction.SOUTH:return e.s;case x.Direction.WEST:return e.w}}(n.grid[a][r],e)},cn=function(n,t){for(var e=arguments.length,r=new Array(e>2?e-2:0),a=2;a<e;a++)r[a-2]=arguments[a];return!!r.reduce((function(t,e){return t&&on(n,t,e)?w.neighbor(t,e):void 0}),t)},un=function n(t,e,r,a){if(on(t,r,e)&&a>0){var i=w.neighbor(r,e);return[i].concat(Object(H.a)(n(t,e,i,a-1)))}return[]},dn=function(n,t){var e=[];return(cn(n,t,x.Direction.NORTH,x.Direction.EAST)||cn(n,t,x.Direction.EAST,x.Direction.NORTH))&&e.push(w.create(t.x+1,t.y-1)),(cn(n,t,x.Direction.NORTH,x.Direction.WEST)||cn(n,t,x.Direction.WEST,x.Direction.NORTH))&&e.push(w.create(t.x-1,t.y-1)),(cn(n,t,x.Direction.SOUTH,x.Direction.EAST)||cn(n,t,x.Direction.EAST,x.Direction.SOUTH))&&e.push(w.create(t.x+1,t.y+1)),(cn(n,t,x.Direction.SOUTH,x.Direction.WEST)||cn(n,t,x.Direction.WEST,x.Direction.SOUTH))&&e.push(w.create(t.x-1,t.y+1)),e},sn=function(n,t,e){return x.all().reduce((function(r,a){return r.concat(un(n,a,t,e))}),[]).concat(dn(n,t)).concat(t)},fn=function(n){return"Loading"===n.state},ln=function(n){return"Loaded"===n.state},pn=function(n){return"Errored"===n.state},mn=function(){return{state:"Loading"}},yn=function(n){return{state:"Loaded",data:n}},vn=function(n){return{state:"Errored",e:n}},En=function(n,t){return ln(t)?yn(n(t.data)):t},bn=e(32),hn=function(){return Object(bn.v4)()},gn=function(n){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:w.create(),e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:5,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:On();return{id:p.create(),name:n,position:t,type:"player",visionRadius:e,displayName:r||n,cls:y.EntityClass.PLAYER}},On=function(){return a.randomItem(["\ud83d\udc15","\ud83d\udc26","\ud83d\udc08","\ud83d\udc0e","\ud83d\udc16","\ud83d\udc01","\ud83d\udc00","\ud83d\udc22"])};!function(n){n.PLAYER="PLAYER",n.INANIMATE="INANIMATE",n.HOSTILE="HOSTILE"}(M||(M={}));var wn,Tn=function(n){return n.type,"transparent"},Sn=function(n){switch(n.type){case"player":return n.displayName;case"blind-guardian":return E.DISPLAY;case"exit":return O.DISPLAY;case"wandering-husk":return g.DISPLAY}},xn=function(n){switch(n.type){case"player":return n.name;case"blind-guardian":return"a blind guardian";case"exit":return"an exit";case"wandering-husk":return"a wandering husk"}},kn=function(n,t){switch(n.type){case"blind-guardian":return E.next(n,t);case"wandering-husk":return g.next(n,t);default:return[]}},An=function(n,t){switch(t.type){case"blind-guardian":return"".concat(n.name," has been annihilated by ").concat(xn(t),". Nothing is left.");case"wandering-husk":return"Blood and sinew cling to the maw of the wandering husk. ".concat(n.name," has been consumed.")}},Mn=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:w.create();return{type:"blind-guardian",position:n,id:p.create(),heading:x.Direction.NORTH,cls:y.EntityClass.HOSTILE}},jn=function(n,t){var e,r=x.all().filter((function(e){return f.canWalk(t.maze,n.position,e)})),i=r.filter((function(t){return t!==x.inverse(n.heading)}));return e=r.includes(n.heading)&&Math.random()<.75?n.heading:Math.random()<.75&&i.length>0?a.randomItem(i):r[0],[S.update(Object(q.a)({},n,{heading:e})),S.move(n.id,e)]},_n="\ud83d\uddff",In=function(n,t){return{entityMap:n.reduce((function(n,t){return n[t.id]=t,n}),{}),positionMap:n.reduce((function(n,e){var r=w.toIndex(e.position,t);return n[r]=n[r]?[].concat(Object(H.a)(n[r]),[e.id]):[e.id],n}),{}),playerEntityId:A.map((function(n){return n.id}),n.find((function(n){return"player"===n.type}))),typeMap:n.reduce((function(n,t){return Object(q.a)({},n,Object(K.a)({},t.type,n[t.type]?[].concat(Object(H.a)(n[t.type]),[t.id]):[t.id]))}),{})}},Dn=function(n,t,e){var r=w.toIndex(t,e);return(n.positionMap[r]||[]).map((function(t){return n.entityMap[t]}))},Pn=function(n){return A.map((function(t){return n.entityMap[t]}),n.playerEntityId)},Nn=function(n,t,e,r){var a=t.entityMap[n];if(null!=a){var i,o=w.toIndex(a.position,r),c=w.toIndex(e,r),u=Object(q.a)({},a,{position:e});return Object(q.a)({},t,{entityMap:Object(q.a)({},t.entityMap,Object(K.a)({},n,u)),positionMap:Object(q.a)({},t.positionMap,(i={},Object(K.a)(i,o,Object(H.a)((t.positionMap[o]||[]).filter((function(t){return t!==n})))),Object(K.a)(i,c,[].concat(Object(H.a)(t.positionMap[c]||[]),[n])),i))})}return t},Rn=function(n,t){return Object(q.a)({},t,{entityMap:Object(q.a)({},t.entityMap,Object(K.a)({},n.id,n))})},Ln=function(n,t,e,r){var a=n.entityMap[e],i=n.entityMap[r],o=t.entityMap[e],c=t.entityMap[r];return w.equals(o.position,i.position)&&w.equals(c.position,a.position)},Cn=function(n,t,e,r){return w.neighbors(t.entityMap[e].position,r).map((function(n){return w.toIndex(n,r)})).reduce((function(n,e){return n.concat(t.positionMap[e]||[])}),[]).filter((function(r){return Ln(n,t,e,r)})).map((function(n){return t.entityMap[n]}))},Un=function(n,t){var e=b.getPlayer(t),r=new Set(e?f.seenFromPoint(n,e.position,e.visionRadius).map((function(t){return w.toIndex(t,n.dimension)})):[]);return{maze:n,entityData:t,seen:new Set,sees:r,stepCount:0}},Wn=function(n){var t=n.maze,e=n.entityData,r=n.seen,a=n.sees;return t.grid.reduce((function(n,i,o){return[].concat(Object(H.a)(n),[i.reduce((function(n,i,c){var u=w.create(c,o),d=r.has(w.toIndex(u,t.dimension)),s=a.has(w.toIndex(u,t.dimension));return n.concat({cell:i,meta:{occupants:b.entitiesAtPoint(e,w.create(c,o),t.dimension),visible:s,seen:d,unknown:!s&&!d}})}),[])])}),[])},Hn=function(n){return Object.keys(n.entityData.entityMap).map((function(t){return n.entityData.entityMap[t]})).filter((function(n){return"player"!==n.type})).reduce((function(t,e){return t.concat(v.generateAiInstructions(e,n))}),[])},zn=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:w.create();return{type:"wandering-husk",position:n,id:p.create(),heading:x.random(),cls:y.EntityClass.HOSTILE}},Gn=function(n,t){var e,r=x.all().reduce((function(e,r){return e||(Bn(r,n.position,t)?r:void 0)}),void 0),a=[];return r?Math.random()<.9?(e=r,a.push(S.move(n.id,e))):(e=n.heading,a.push(S.wait(n.id))):(e=Yn(n,t),a.push(S.move(n.id,e))),[S.update(Object(q.a)({},n,{heading:e}))].concat(a)},Yn=function(n,t){var e=x.all().filter((function(e){return f.canWalk(t.maze,n.position,e)})),r=e.filter((function(t){return t!==x.inverse(n.heading)}));return e.includes(n.heading)&&Math.random()<.75?n.heading:Math.random()<.75&&r.length>0?a.randomItem(r):e[0]},Bn=function(n,t,e){return f.lookInDirection(e.maze,n,t,5).reduce((function(n,t){return n||null!=b.entitiesAtPoint(e.entityData,t,e.maze.dimension).find((function(n){return"player"===n.type}))}),!1)},Qn="\ud83e\udddf",Vn=function(n){return{position:n,id:p.create(),type:"exit",cls:y.EntityClass.INANIMATE}},Fn="\ud83d\udeaa",Kn=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return{x:n,y:t}},qn=function(n,t){var e=n.x;return n.y*t.width+e},Jn=function(n,t){var e=t.width;return Kn(n%e,Math.floor(n/e))},Xn=function(n,t){switch(t){case"NORTH":return w.create(n.x,n.y-1);case"SOUTH":return w.create(n.x,n.y+1);case"EAST":return w.create(n.x+1,n.y);case"WEST":default:return w.create(n.x-1,n.y)}},Zn=function(n,t){return x.all().map((function(t){return Xn(n,t)})).filter((function(n){return d.inBounds(t,n)}))},$n=function(n,t){return[Kn(n.x-1,n.y-1),Kn(n.x+1,n.y-1),Kn(n.x+1,n.y+1),Kn(n.x-1,n.y+1)].filter((function(n){return d.inBounds(t,n)}))},nt=function(n,t){return n.x===t.x&&n.y===t.y},tt=function(){for(var n=arguments.length,t=new Array(n),e=0;e<n;e++)t[e]=arguments[e];return{instructions:t,id:p.create()}};!function(n){n.MOVE="MOVE",n.UPDATE="UPDATE",n.WAIT="WAIT"}(wn||(wn={}));var et,rt=function(n,t){return{type:wn.MOVE,entityId:n,payload:{direction:t}}},at=function(n,t,e){var r=new Set(f.seenFromPoint(e,t.position,t.visionRadius).map((function(n){return w.toIndex(n,e.dimension)})));return{sees:r,seen:new Set([].concat(Object(H.a)(n),Object(H.a)(r)))}},it=function(n){return{type:wn.UPDATE,entityId:n.id,payload:{updated:n}}},ot=function(n){return{type:wn.WAIT,entityId:n}},ct=function(n,t){switch(n.type){case wn.MOVE:return function(n,t){return f.canWalk(t.maze,t.entityData.entityMap[n.entityId].position,n.payload.direction)?k.ok(void 0):k.err("way is blocked")}(n,t);case wn.WAIT:return k.ok(void 0);default:return k.err("Unkown instruction of type ".concat(n.type))}},ut=function(n,t){return n.reduce((function(n,e){return k.isOk(n)?ct(e,t):n}),k.ok(void 0))},dt=function(n,t){try{switch(n.type){case wn.MOVE:return k.ok(function(n,t){var e=b.moveEntity(n.entityId,t.entityData,w.neighbor(t.entityData.entityMap[n.entityId].position,n.payload.direction),t.maze.dimension),r=b.getPlayer(e),a=r&&n.entityId===r.id?at(t.seen,r,t.maze):t,i=a.seen,o=a.sees;return Object(q.a)({},t,{seen:i,sees:o,entityData:e})}(n,t));case wn.UPDATE:return k.ok(function(n,t){return Object(q.a)({},t,{entityData:b.updateEntity(n.payload.updated,t.entityData)})}(n,t));case wn.WAIT:return k.ok(function(n,t){return Object(q.a)({},t)}(0,t))}}catch(e){return console.warn("Error applying instruction",n),console.error(e),k.err("Error applying instructions")}},st=function(n,t){return n.reduce((function(n,t){return k.isOk(n)?dt(t,n.data):n}),k.ok(t))};!function(n){n.NORTH="NORTH",n.SOUTH="SOUTH",n.EAST="EAST",n.WEST="WEST"}(et||(et={}));var ft,lt=function(){return[et.NORTH,et.SOUTH,et.EAST,et.WEST]},pt=function(n){switch(n){case et.NORTH:return et.SOUTH;case et.SOUTH:return et.NORTH;case et.EAST:return et.WEST;case et.WEST:return et.EAST}},mt=function(){return a.randomItem(lt())},yt=function(n){return{type:"Ok",data:n}},vt=function(n){return{type:"Error",msg:n}},Et=function(n){return"Error"===n.type},bt=function(n){return"Ok"===n.type},ht=function(n,t){return bt(t)?yt(n(t.data)):t},gt=(e(28),function(n){return n}),Ot=function(){},wt=function(n,t){return null!=n?n:"function"===typeof t?t():t},Tt=function(n,t){return null!=t?n(t):void 0},St=function(n,t){t&&n(t)},xt=e(18),kt=function(n){return n},At=Object(xt.a)(kt,(function(n){return n.game})),Mt=Object(xt.a)(At,(function(n){return l.map(h.displayGrid,n)})),jt=Object(xt.a)(kt,(function(n){return null!=n.stepId})),_t=Object(xt.a)(At,(function(n){return l.isLoaded(n)?A.map((function(t){return n.data.entityData.entityMap[t]}),n.data.entityData.playerEntityId):void 0})),It=Object(xt.a)(Mt,_t,(function(n,t){return l.map((function(n){return null!=t?o.centerOnPoint(n,t.position,3):[]}),n)})),Dt=e(16),Pt=e.n(Dt),Nt=e(13),Rt=e.n(Nt),Lt=e(33),Ct=e.n(Lt),Ut=function(n){return _.a.createElement("div",{className:Ct.a.root},v.getDisplayName(n))},Wt=function(n){return n?"0.5px solid cyan":"0.5px transparent"},Ht=function(n){var t,e=n.cell,r=n.meta,a=e.walls;return _.a.createElement("div",{className:Rt()(Pt.a.root,(t={},Object(K.a)(t,Pt.a.seen,r.seen),Object(K.a)(t,Pt.a.visible,r.visible),Object(K.a)(t,Pt.a.unknown,!r.seen&&!r.visible),t)),style:r.unknown?void 0:{borderTop:Wt(a.n),borderRight:Wt(a.e),borderBottom:Wt(a.s),borderLeft:Wt(a.w)}},A.map((function(n){return _.a.createElement(Ut,n)}),function(n){var t=n.visible,e=n.seen,r=n.occupants;return t?A.withDefault(r.find((function(n){return"player"!==n.type&&"exit"!==n.type})),r[0]):e?r.find((function(n){return"exit"===n.type})):void 0}(r)))},zt=function(){return _.a.createElement("div",{className:Rt()(Pt.a.empty,Pt.a.root)})},Gt=e(24),Yt=e.n(Gt),Bt=function(n){var t=n.grid;return _.a.createElement("div",{className:Yt.a.root},t.map((function(n,t){return _.a.createElement("div",{key:t,className:Yt.a.row},n.map((function(n,t){return A.withDefault(A.map((function(n){return _.a.createElement(Ht,{key:t,cell:n.cell,meta:n.meta})}),n),_.a.createElement(zt,{key:t}))})))})))},Qt=e(7),Vt=e.n(Qt),Ft=function(n){var t=n.onMove;return _.a.createElement("div",{className:Vt.a.root},_.a.createElement("div",{className:Vt.a.row},_.a.createElement("div",{className:Vt.a.block}),_.a.createElement("button",{className:Rt()(Vt.a.block,Vt.a.button),onClick:function(){return t(x.Direction.NORTH)}}),_.a.createElement("div",{className:Vt.a.block})),_.a.createElement("div",{className:Vt.a.row},_.a.createElement("button",{className:Rt()(Vt.a.block,Vt.a.button),onClick:function(){return t(x.Direction.WEST)}}),_.a.createElement("button",{className:Rt()(Vt.a.block,Vt.a.button,Vt.a.wait),onClick:function(){return t(void 0)}}),_.a.createElement("button",{className:Rt()(Vt.a.block,Vt.a.button),onClick:function(){return t(x.Direction.EAST)}})),_.a.createElement("div",{className:Vt.a.row},_.a.createElement("div",{className:Vt.a.block}),_.a.createElement("button",{className:Rt()(Vt.a.block,Vt.a.button),onClick:function(){return t(x.Direction.SOUTH)}}),_.a.createElement("div",{className:Vt.a.block})))},Kt=e(34),qt=e(35),Jt=e(38),Xt=e(36),Zt=e(39),$t=function(n){function t(){var n,e;Object(Kt.a)(this,t);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=Object(Jt.a)(this,(n=Object(Xt.a)(t)).call.apply(n,[this].concat(a)))).handleKeyDown=function(n){e.props.disabled||("ArrowUp"===n.key||"w"===n.key?e.props.onMove(x.Direction.NORTH):"ArrowRight"===n.key||"d"===n.key?e.props.onMove(x.Direction.EAST):"ArrowDown"===n.key||"d"===n.key?e.props.onMove(x.Direction.SOUTH):"ArrowLeft"===n.key||"a"===n.key?e.props.onMove(x.Direction.WEST):" "!==n.key&&"Enter"!==n.key||e.props.onMove(void 0))},e}return Object(Zt.a)(t,n),Object(qt.a)(t,[{key:"componentDidMount",value:function(){window.addEventListener("keydown",this.handleKeyDown)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("keydown",this.handleKeyDown)}},{key:"render",value:function(){return j.createElement(j.Fragment,null)}}]),t}(j.PureComponent),ne=function(n){var t=n.grid,e=n.onMove,r=n.processingUpdates;return j.createElement(j.Fragment,null,j.createElement(Bt,{grid:t}),j.createElement(Ft,{onMove:e}),j.createElement($t,{onMove:e,disabled:r}))};!function(n){n.REQUEST_NEW_GAME="REQUEST_NEW_GAME",n.START_NEW_GAME="START_NEW_GAME",n.REQUEST_STEP="REQUEST_STEP",n.PROCESS_STEP="PROCESS_STEP",n.COMPLETE_STEP="COMPLETE_STEP",n.ABORT_STEP="ABORT_STEP",n.MOVE_PLAYER="MOVE_PLAYER"}(ft||(ft={}));var te,ee=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{type:ft.REQUEST_NEW_GAME,options:n}},re=function(n,t){return{type:ft.START_NEW_GAME,maze:n,entities:t}},ae=function(n){return{type:ft.ABORT_STEP,stepId:n}},ie=function(n,t){return{type:ft.PROCESS_STEP,stepId:n,gameData:t}},oe="true"===c.getSiteSetting("devmode",(function(){var n=u.parseQuery().devmode;return n&&"false"!==n?"true":void 0}));fetch("".concat(window.location.href.substring(0,window.location.href.indexOf("?")),"/VERSION")).then((function(n){return n.text().then((function(n){return te=n}))}));var ce=Object(C.b)((function(n){return{gameData:At(n)}}))((function(n){var t=n.gameData;return oe&&l.isLoaded(t)?_.a.createElement("button",{onFocus:function(n){return n.preventDefault()},style:{position:"absolute",top:5,left:5},onClick:function(){window.alert(function(n){return["maze algorithm:: ".concat(n.maze.algorithm),"maze dimensions:: ".concat(n.maze.dimension.width," x ").concat(n.maze.dimension.height),"entityCount:: ".concat((t=n.entityData,"\n\t"+Object.keys(t.typeMap).map((function(n){return"".concat(n,": ").concat(t.typeMap[n].length)})).join("\n\t"))),"step:: ".concat(n.stepCount),"version:: ".concat(te)].join("\n");var t}(t.data)),A.ifPresent((function(n){return n.blur()}),document.activeElement)}},"?"):_.a.createElement(_.a.Fragment,null)})),ue=Object(C.b)((function(n){return{grid:It(n),processingUpdates:jt(n)}}),(function(n){return{onMove:function(t){return n((e=t,{type:ft.MOVE_PLAYER,direction:e}));var e}}}))((function(n){var t=n.grid,e=n.processingUpdates,r=n.onMove;return _.a.createElement("div",{className:L.a.root},l.isLoading(t)&&_.a.createElement("span",null,"Loading . . . "),l.isLoaded(t)&&t.data&&_.a.createElement(_.a.Fragment,null,_.a.createElement(ce,null),_.a.createElement(ne,{processingUpdates:e,grid:t.data,onMove:r})))})),de=e(14),se=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(q.a)({game:l.loading()},n)},fe=function(n){return Object(q.a)({},n,{game:l.loading()})},le=function(n,t,e){return Object(q.a)({},n,{game:l.loaded(h.create(t,b.fromEntities(e,t.dimension)))})},pe=function(n,t){return l.isLoaded(t.game)?n():t},me=function(n,t){return Object(q.a)({},n,{stepId:t})},ye=function(n,t,e){return pe((function(){return n.stepId===t?Object(q.a)({},n,{game:l.loaded(e)}):n}),n)},ve=function(n,t){return pe((function(){return n.stepId===t?Object(q.a)({},n,{stepId:void 0,game:l.map((function(n){return Object(q.a)({},n,{stepCount:n.stepCount+1})}),n.game)}):n}),n)},Ee=function(n,t){return n.stepId===t?Object(q.a)({},n,{stepId:void 0}):n},be=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:se(),t=arguments.length>1?arguments[1]:void 0;switch(t.type){case ft.REQUEST_STEP:return me(n,t.step.id);case ft.COMPLETE_STEP:return ve(n,t.stepId);case ft.ABORT_STEP:return Ee(n,t.stepId);case ft.PROCESS_STEP:return ye(n,t.stepId,t.gameData);case ft.START_NEW_GAME:return le(n,t.maze,t.entities);case ft.REQUEST_NEW_GAME:return fe(n);default:return n}},he=e(37),ge=e(8),Oe=e.n(ge),we=e(5),Te=Oe.a.mark(xe),Se=Oe.a.mark(ke);function xe(){var n,t,e,r,a,i,o,c;return Oe.a.wrap((function(u){for(;;)switch(u.prev=u.next){case 0:return u.prev=1,u.next=4,Object(we.f)(ft.REQUEST_STEP);case 4:return n=u.sent,t=n.step,u.next=8,Object(we.d)(At);case 8:if(e=u.sent,!l.isLoaded(e)){u.next=33;break}return r=e.data,u.next=13,Object(we.b)(S.validateAll,t.instructions,r);case 13:if(a=u.sent,!k.isErr(a)){u.next=18;break}return u.next=17,Object(we.c)(ae(t.id));case 17:return u.abrupt("continue",0);case 18:return i=h.generateAllAIInstructions(r),o=[].concat(Object(H.a)(i),Object(H.a)(t.instructions)),u.next=22,Object(we.b)(S.applyAll,o,r);case 22:if(c=u.sent,!k.isErr(c)){u.next=27;break}return u.next=26,Object(we.c)(ae(t.id));case 26:return u.abrupt("continue",0);case 27:return u.next=29,Object(we.c)(ie(t.id,c.data));case 29:return u.next=31,Object(we.b)(ke,r,c.data);case 31:return u.next=33,Object(we.c)((d=t.id,{type:ft.COMPLETE_STEP,stepId:d}));case 33:u.next=39;break;case 35:u.prev=35,u.t0=u.catch(1),console.warn("Error processing step"),console.error(u.t0);case 39:u.next=0;break;case 41:case"end":return u.stop()}var d}),Te,null,[[1,35]])}function ke(n,t){var e,r,a;return Oe.a.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(e=b.getPlayer(t.entityData),r=b.entitiesAtPoint(t.entityData,e.position,t.maze.dimension).filter((function(n){return n.id!==e.id})).concat(b.neighborsCrossedByEntity(n.entityData,t.entityData,e.id,t.maze.dimension)),a=r.find((function(n){return n.cls===M.HOSTILE})),0!==r.length){i.next=7;break}return i.abrupt("return");case 7:if(!a){i.next=13;break}return i.next=10,Object(we.b)(window.confirm,v.getKillMessage(e,a));case 10:window.location.reload(),i.next=17;break;case 13:if(!r.find((function(n){return"exit"===n.type}))){i.next=17;break}return i.next=16,Object(we.b)(window.confirm,"".concat(e.name," escaped. . . this time."));case 16:window.location.reload();case 17:case"end":return i.stop()}}),Se)}var Ae=Oe.a.mark(Me);function Me(){return Oe.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,Object(we.g)(ft.MOVE_PLAYER,Oe.a.mark((function n(t){var e;return Oe.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,Object(we.d)(_t);case 2:return e=n.sent,n.next=5,Object(we.d)(jt);case 5:if(n.sent||!e){n.next=9;break}return n.next=9,Object(we.c)((r=T.create(t.direction?S.move(e.id,t.direction):S.wait(e.id)),{type:ft.REQUEST_STEP,step:r}));case 9:case"end":return n.stop()}var r}),n)})));case 2:case"end":return n.stop()}}),Ae)}var je=Oe.a.mark(De),_e=Oe.a.mark(Pe),Ie=A.withDefault(A.of(localStorage.getItem("name")),(function(){var n=window.prompt("What is your name?")||"";return""!==n&&localStorage.setItem("name",n),""!==n?n:"?"}));function De(){return Oe.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,Object(we.c)(ee({mazeOptions:{dimension:a.randomItem([d.create(10,10),d.create(15,15),d.create(15,15),d.create(15,15),d.create(15,15),d.create(20,20),d.create(25,15),d.create(15,20),d.create(30,5)]),algorithm:a.randomItem(["aldous-broder","aldous-broder","aldous-broder","binary-tree","side-winder"])}}));case 2:case"end":return n.stop()}}),je)}function Pe(){var n,t,e,a;return Oe.a.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.prev=1,i.next=4,Object(we.f)(ft.REQUEST_NEW_GAME);case 4:return n=i.sent,t=n.options,i.next=8,Object(we.b)(r.maze,t.mazeOptions||{});case 8:return e=i.sent,a=f.fromMazeData(e),i.next=12,Object(we.c)(re(a,Ne(a)));case 12:i.next=18;break;case 14:i.prev=14,i.t0=i.catch(1),console.warn("Error initializing new game"),console.error(i.t0);case 18:i.next=0;break;case 20:case"end":return i.stop()}}),_e,null,[[1,14]])}var Ne=function(n){var t=n.dimension,e=m.create(Ie,d.pointAlongEdge(t)),r=O.create(d.randomPoint(t)),o=new Array(i.randomInRange(1,5)).fill(void 0).map((function(n){return E.create(d.randomPoint(t))})),c=new Array(a.randomItem([1,1,2,2,3])).fill(void 0).map((function(n){return g.create(d.randomPoint(t))})),u=[].concat(Object(H.a)(o),Object(H.a)(c));return[e,r].concat(Object(H.a)(u))},Re=Oe.a.mark(Ce),Le=[De,Pe,xe,Me];function Ce(){return Oe.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,Object(we.a)(Le.map((function(n){return Object(we.e)(n)})));case 2:case"end":return n.stop()}}),Re)}D.a.render(_.a.createElement(C.a,{store:function(){var n=Object(he.a)(),t=Object(de.d)(be,Object(de.a)(n));return n.run(Ce),t}()},_.a.createElement("div",{className:N.a.app},_.a.createElement(ue,null))),document.getElementById("root"))},7:function(n,t,e){n.exports={root:"GamePad_root__Lay6t",row:"GamePad_row__164Sm",block:"GamePad_block__l2_xd",button:"GamePad_button__3kDFo",wait:"GamePad_wait__5DVYu"}}},[[40,1,2]]]);
//# sourceMappingURL=main.954ef78a.chunk.js.map