(this.webpackJsonpfollowed=this.webpackJsonpfollowed||[]).push([[0],{16:function(n,t,e){n.exports={root:"Cell_root__2ti8K",empty:"Cell_empty__1ByI9",seen:"Cell_seen__2qSTX",visible:"Cell_visible__2bnT3",unknown:"Cell_unknown__2tYkG"}},24:function(n,t,e){n.exports={root:"Grid_root__xSU_B",row:"Grid_row__1rWaL"}},28:function(n,t){},29:function(n,t){},30:function(n,t,e){n.exports={app:"index_app__2lpzC"}},31:function(n,t,e){n.exports={root:"App_root__ZxxJN"}},34:function(n,t,e){n.exports={root:"Entity_root__MaGTf"}},41:function(n,t,e){n.exports=e(54)},54:function(n,t,e){"use strict";e.r(t);var r={};e.r(r),e.d(r,"maze",(function(){return R}));var i={};e.r(i),e.d(i,"nOf",(function(){return W})),e.d(i,"sorted",(function(){return L})),e.d(i,"nonNull",(function(){return H})),e.d(i,"randomItem",(function(){return C}));var a={};e.r(a),e.d(a,"randomInRange",(function(){return G}));var o={};e.r(o),e.d(o,"centerOnPoint",(function(){return z}));var u={};e.r(u),e.d(u,"create",(function(){return B})),e.d(u,"area",(function(){return Y})),e.d(u,"randomPoint",(function(){return Q})),e.d(u,"pointAlongEdge",(function(){return V})),e.d(u,"inBounds",(function(){return F}));var c={};e.r(c),e.d(c,"fromApi",(function(){return q}));var d={};e.r(d),e.d(d,"fromMazeData",(function(){return K})),e.d(d,"canWalk",(function(){return X})),e.d(d,"canTravel",(function(){return Z})),e.d(d,"lookInDirection",(function(){return $})),e.d(d,"peekableCorners",(function(){return nn})),e.d(d,"seenFromPoint",(function(){return tn}));var s={};e.r(s),e.d(s,"isLoading",(function(){return en})),e.d(s,"isLoaded",(function(){return rn})),e.d(s,"isErrored",(function(){return an})),e.d(s,"loading",(function(){return on})),e.d(s,"loaded",(function(){return un})),e.d(s,"errored",(function(){return cn})),e.d(s,"map",(function(){return dn}));var f={};e.r(f),e.d(f,"create",(function(){return fn}));var l={};e.r(l),e.d(l,"create",(function(){return ln})),e.d(l,"randomDisplayName",(function(){return pn}));var p={};e.r(p),e.d(p,"getColor",(function(){return mn})),e.d(p,"getDisplayName",(function(){return yn})),e.d(p,"generateAiInstructions",(function(){return vn}));var m={};e.r(m),e.d(m,"create",(function(){return bn})),e.d(m,"next",(function(){return On})),e.d(m,"DISPLAY",(function(){return hn}));var y={};e.r(y),e.d(y,"create",(function(){return gn})),e.d(y,"DISPLAY",(function(){return wn}));var v={};e.r(v),e.d(v,"create",(function(){return Tn})),e.d(v,"toIndex",(function(){return xn})),e.d(v,"fromIndex",(function(){return kn})),e.d(v,"neighbor",(function(){return _n})),e.d(v,"neighbors",(function(){return Sn})),e.d(v,"diagonalNeighbors",(function(){return Mn})),e.d(v,"equals",(function(){return An}));var E={};e.r(E),e.d(E,"create",(function(){return jn}));var b={};e.r(b),e.d(b,"fromEntities",(function(){return In})),e.d(b,"entitiesAtPoint",(function(){return Nn})),e.d(b,"getPlayer",(function(){return Pn})),e.d(b,"moveEntity",(function(){return Rn})),e.d(b,"updateEntity",(function(){return Un})),e.d(b,"entitiesCrossed",(function(){return Wn})),e.d(b,"neighborsCrossedByEntity",(function(){return Ln}));var O={};e.r(O),e.d(O,"create",(function(){return Hn})),e.d(O,"displayGrid",(function(){return Cn})),e.d(O,"generateAllAIInstructions",(function(){return Gn}));var h={};e.r(h),e.d(h,"move",(function(){return Bn})),e.d(h,"update",(function(){return Qn})),e.d(h,"wait",(function(){return Vn})),e.d(h,"validate",(function(){return Fn})),e.d(h,"validateAll",(function(){return qn})),e.d(h,"apply",(function(){return Jn})),e.d(h,"applyAll",(function(){return Kn}));var g={};e.r(g),e.d(g,"Direction",(function(){return zn})),e.d(g,"all",(function(){return Zn})),e.d(g,"inverse",(function(){return $n}));var w={};e.r(w),e.d(w,"ok",(function(){return nt})),e.d(w,"err",(function(){return tt})),e.d(w,"isErr",(function(){return et})),e.d(w,"isOk",(function(){return rt})),e.d(w,"map",(function(){return it}));var T={};e.r(T),e.d(T,"of",(function(){return at})),e.d(T,"none",(function(){return ot})),e.d(T,"withDefault",(function(){return ut})),e.d(T,"map",(function(){return ct})),e.d(T,"ifPresent",(function(){return dt}));var x,k=e(1),_=e.n(k),S=e(18),M=e.n(S),A=e(30),j=e.n(A),D=e(31),I=e.n(D),N=e(20),P="https://fv9o21r19a.execute-api.us-east-1.amazonaws.com/dev",R=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=n.dimension,e=void 0===t?u.create(10,10):t,r=n.algorithm,i=void 0===r?"aldous-broder":r,a=fetch("".concat(P),{method:"post",mode:"cors",headers:{"content-type":"application/json"},body:JSON.stringify({dimensions:e,algorithm:i})});return a.then((function(n){return n.text()})).then((function(n){return c.fromApi(e,n)}))},U=e(7),W=function(n,t){return new Array(n).fill(t)},L=function(n,t){var e=Object(U.a)(n);return e.sort(t),e},H=function(n){return n.filter((function(n){return null!=n}))},C=function(n){return n[Math.floor(Math.random()*n.length)]},G=function(n,t){return n+Math.floor(Math.random()*(t-n-1))},z=function(n,t,e){for(var r=t.x-e,i=t.x+e+1,a=t.y-e,o=t.y+e+1,u=[],c=a;c<o;c++){for(var d=[],s=function(t){d.push(T.map((function(n){return n[t]}),n[c]))},f=r;f<i;f++)s(f);u.push(d)}return u},B=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return{width:n,height:t}},Y=function(n){return n.width*n.height},Q=function(n){return v.fromIndex(Math.floor(Math.random()*Y(n)),n)},V=function(n){var t=Math.random()>.5;return v.create(t?a.randomInRange(0,n.width):Math.random()>.5?0:n.width-1,t?Math.random()>.5?0:n.height-1:a.randomInRange(0,n.height))},F=function(n,t){return t.x>0&&t.y>0&&t.x<n.width&&t.y<n.height},q=function(n,t){return{bytes:Uint8Array.from(atob(t),(function(n){return n.charCodeAt(0)})),dimension:n}},J=function(n){return{walls:(t={n:!((8&n)>0),s:!((4&n)>0),e:!((2&n)>0),w:!((1&n)>0)},{n:t.n||!1,e:t.e||!1,s:t.s||!1,w:t.w||!1})};var t},K=function(n){for(var t=n.dimension,e=n.bytes,r=[],i=0;i<t.height;i++){for(var a=[],o=0;o<t.width;o++)a.push(J(e[i*t.width+o]));r.push(a)}return{grid:r,dimension:t}},X=function(n,t,e){var r=t.x,i=t.y;return!function(n,t){var e=n.walls;switch(t){case g.Direction.NORTH:return e.n;case g.Direction.EAST:return e.e;case g.Direction.SOUTH:return e.s;case g.Direction.WEST:return e.w}}(n.grid[i][r],e)},Z=function(n,t){for(var e=arguments.length,r=new Array(e>2?e-2:0),i=2;i<e;i++)r[i-2]=arguments[i];return!!r.reduce((function(t,e){return t&&X(n,t,e)?v.neighbor(t,e):void 0}),t)},$=function n(t,e,r,i){if(X(t,r,e)&&i>0){var a=v.neighbor(r,e);return[a].concat(Object(U.a)(n(t,e,a,i-1)))}return[]},nn=function(n,t){var e=[];return(Z(n,t,g.Direction.NORTH,g.Direction.EAST)||Z(n,t,g.Direction.EAST,g.Direction.NORTH))&&e.push(v.create(t.x+1,t.y-1)),(Z(n,t,g.Direction.NORTH,g.Direction.WEST)||Z(n,t,g.Direction.WEST,g.Direction.NORTH))&&e.push(v.create(t.x-1,t.y-1)),(Z(n,t,g.Direction.SOUTH,g.Direction.EAST)||Z(n,t,g.Direction.EAST,g.Direction.SOUTH))&&e.push(v.create(t.x+1,t.y+1)),(Z(n,t,g.Direction.SOUTH,g.Direction.WEST)||Z(n,t,g.Direction.WEST,g.Direction.SOUTH))&&e.push(v.create(t.x-1,t.y+1)),e},tn=function(n,t,e){return g.all().reduce((function(r,i){return r.concat($(n,i,t,e))}),[]).concat(nn(n,t)).concat(t)},en=function(n){return"Loading"===n.state},rn=function(n){return"Loaded"===n.state},an=function(n){return"Errored"===n.state},on=function(){return{state:"Loading"}},un=function(n){return{state:"Loaded",data:n}},cn=function(n){return{state:"Errored",e:n}},dn=function(n,t){return rn(t)?un(n(t.data)):t},sn=e(33),fn=function(){return Object(sn.v4)()},ln=function(n){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:v.create(),e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:5,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:pn();return{id:f.create(),name:n,position:t,type:"player",visionRadius:e,displayName:r||n}},pn=function(){return i.randomItem(["\ud83d\udc15","\ud83d\udc26","\ud83d\udc08","\ud83d\udc0e","\ud83d\udc16","\ud83d\udc01","\ud83d\udc00","\ud83d\udc22"])},mn=(e(28),function(n){switch(n.type){case"player":return"var(--blue)";case"exit":case"blind-guardian":return"transparent";default:return"var(--red)"}}),yn=function(n){switch(n.type){case"player":return n.displayName;case"blind-guardian":return m.DISPLAY;case"exit":return y.DISPLAY}},vn=function(n,t){switch(n.type){case"blind-guardian":return m.next(n,t);default:return[]}},En=e(5),bn=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:v.create();return{type:"blind-guardian",position:n,id:f.create(),heading:g.Direction.NORTH}},On=function(n,t){var e,r=g.all().filter((function(e){return d.canWalk(t.maze,n.position,e)})),a=r.filter((function(t){return t!==g.inverse(n.heading)}));return e=r.includes(n.heading)&&Math.random()<.75?n.heading:Math.random()<.75&&a.length>0?i.randomItem(a):r[0],[h.update(Object(En.a)({},n,{heading:e})),h.move(n.id,e)]},hn="\ud83d\uddff",gn=function(n){return{position:n,id:f.create(),type:"exit"}},wn="\ud83d\udeaa",Tn=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return{x:n,y:t}},xn=function(n,t){var e=n.x;return n.y*t.width+e},kn=function(n,t){var e=t.width;return Tn(Math.floor(n/e),n%e)},_n=function(n,t){switch(t){case"NORTH":return v.create(n.x,n.y-1);case"SOUTH":return v.create(n.x,n.y+1);case"EAST":return v.create(n.x+1,n.y);case"WEST":default:return v.create(n.x-1,n.y)}},Sn=function(n,t){return g.all().map((function(t){return _n(n,t)})).filter((function(n){return u.inBounds(t,n)}))},Mn=function(n,t){return[Tn(n.x-1,n.y-1),Tn(n.x+1,n.y-1),Tn(n.x+1,n.y+1),Tn(n.x-1,n.y+1)].filter((function(n){return u.inBounds(t,n)}))},An=function(n,t){return n.x===t.x&&n.y===t.y},jn=function(){for(var n=arguments.length,t=new Array(n),e=0;e<n;e++)t[e]=arguments[e];return{instructions:t,id:f.create()}},Dn=e(10),In=function(n,t){return{entityMap:n.reduce((function(n,t){return n[t.id]=t,n}),{}),positionMap:n.reduce((function(n,e){var r=v.toIndex(e.position,t);return n[r]=n[r]?[].concat(Object(U.a)(n[r]),[e.id]):[e.id],n}),{}),playerEntityId:T.map((function(n){return n.id}),n.find((function(n){return"player"===n.type}))),typeMap:n.reduce((function(n,t){return Object(En.a)({},n,Object(Dn.a)({},t.type,n[t.id]?[].concat(Object(U.a)(n[t.id]),[t.id]):[t.id]))}),{})}},Nn=function(n,t,e){var r=v.toIndex(t,e);return(n.positionMap[r]||[]).map((function(t){return n.entityMap[t]}))},Pn=function(n){return T.map((function(t){return n.entityMap[t]}),n.playerEntityId)},Rn=function(n,t,e,r){var i=t.entityMap[n];if(null!=i){var a,o=v.toIndex(i.position,r),u=v.toIndex(e,r),c=Object(En.a)({},i,{position:e});return Object(En.a)({},t,{entityMap:Object(En.a)({},t.entityMap,Object(Dn.a)({},n,c)),positionMap:Object(En.a)({},t.positionMap,(a={},Object(Dn.a)(a,o,Object(U.a)((t.positionMap[o]||[]).filter((function(t){return t!==n})))),Object(Dn.a)(a,u,[].concat(Object(U.a)(t.positionMap[u]||[]),[n])),a))})}return t},Un=function(n,t){return Object(En.a)({},t,{entityMap:Object(En.a)({},t.entityMap,Object(Dn.a)({},n.id,n))})},Wn=function(n,t,e,r){var i=n.entityMap[e],a=n.entityMap[r],o=t.entityMap[e],u=t.entityMap[r];return v.equals(o.position,a.position)&&v.equals(u.position,i.position)},Ln=function(n,t,e,r){return v.neighbors(t.entityMap[e].position,r).map((function(n){return v.toIndex(n,r)})).reduce((function(n,e){return n.concat(t.positionMap[e]||[])}),[]).filter((function(r){return Wn(n,t,e,r)})).map((function(n){return t.entityMap[n]}))},Hn=function(n,t){var e=b.getPlayer(t),r=new Set(e?d.seenFromPoint(n,e.position,e.visionRadius).map((function(t){return v.toIndex(t,n.dimension)})):[]);return{maze:n,entityData:t,seen:new Set,sees:r}},Cn=function(n){var t=n.maze,e=n.entityData,r=n.seen,i=n.sees;return t.grid.reduce((function(n,a,o){return[].concat(Object(U.a)(n),[a.reduce((function(n,a,u){var c=v.create(u,o),d=r.has(v.toIndex(c,t.dimension)),s=i.has(v.toIndex(c,t.dimension));return n.concat({cell:a,meta:{occupants:b.entitiesAtPoint(e,v.create(u,o),t.dimension),visible:s,seen:d,unknown:!s&&!d}})}),[])])}),[])},Gn=function(n){return Object.keys(n.entityData.entityMap).map((function(t){return n.entityData.entityMap[t]})).filter((function(n){return"player"!==n.type})).reduce((function(t,e){return t.concat(p.generateAiInstructions(e,n))}),[])};!function(n){n.MOVE="MOVE",n.UPDATE="UPDATE",n.WAIT="WAIT"}(x||(x={}));var zn,Bn=function(n,t){return{type:x.MOVE,entityId:n,payload:{direction:t}}},Yn=function(n,t,e){var r=new Set(d.seenFromPoint(e,t.position,t.visionRadius).map((function(n){return v.toIndex(n,e.dimension)})));return{sees:r,seen:new Set([].concat(Object(U.a)(n),Object(U.a)(r)))}},Qn=function(n){return{type:x.UPDATE,entityId:n.id,payload:{updated:n}}},Vn=function(n){return{type:x.WAIT,entityId:n}},Fn=function(n,t){switch(n.type){case x.MOVE:return function(n,t){return d.canWalk(t.maze,t.entityData.entityMap[n.entityId].position,n.payload.direction)?w.ok(void 0):w.err("way is blocked")}(n,t);case x.WAIT:return w.ok(void 0);default:return w.err("Unkown instruction of type ".concat(n.type))}},qn=function(n,t){return n.reduce((function(n,e){return w.isOk(n)?Fn(e,t):n}),w.ok(void 0))},Jn=function(n,t){try{switch(n.type){case x.MOVE:return w.ok(function(n,t){var e=b.moveEntity(n.entityId,t.entityData,v.neighbor(t.entityData.entityMap[n.entityId].position,n.payload.direction),t.maze.dimension),r=b.getPlayer(e),i=r&&n.entityId===r.id?Yn(t.seen,r,t.maze):t,a=i.seen,o=i.sees;return Object(En.a)({},t,{seen:a,sees:o,entityData:e})}(n,t));case x.UPDATE:return w.ok(function(n,t){return Object(En.a)({},t,{entityData:b.updateEntity(n.payload.updated,t.entityData)})}(n,t));case x.WAIT:return w.ok(function(n,t){return Object(En.a)({},t)}(0,t))}}catch(e){return console.warn("Error applying instruction",n),console.error(e),w.err("Error applying instructions")}},Kn=function(n,t){return n.reduce((function(n,t){return w.isOk(n)?Jn(t,n.data):n}),w.ok(t))};!function(n){n.NORTH="NORTH",n.SOUTH="SOUTH",n.EAST="EAST",n.WEST="WEST"}(zn||(zn={}));var Xn,Zn=function(){return[zn.NORTH,zn.SOUTH,zn.EAST,zn.WEST]},$n=function(n){switch(n){case zn.NORTH:return zn.SOUTH;case zn.SOUTH:return zn.NORTH;case zn.EAST:return zn.WEST;case zn.WEST:return zn.EAST}},nt=function(n){return{type:"Ok",data:n}},tt=function(n){return{type:"Error",msg:n}},et=function(n){return"Error"===n.type},rt=function(n){return"Ok"===n.type},it=function(n,t){return rt(t)?nt(n(t.data)):t},at=(e(29),function(n){return n}),ot=function(){},ut=function(n,t){return null!=n?n:"function"===typeof t?t():t},ct=function(n,t){return null!=t?n(t):void 0},dt=function(n,t){t&&n(t)},st=e(17),ft=function(n){return n},lt=Object(st.a)(ft,(function(n){return n.game})),pt=Object(st.a)(lt,(function(n){return s.map(O.displayGrid,n)})),mt=Object(st.a)(ft,(function(n){return null!=n.stepId})),yt=Object(st.a)(lt,(function(n){return s.isLoaded(n)?T.map((function(t){return n.data.entityData.entityMap[t]}),n.data.entityData.playerEntityId):void 0})),vt=Object(st.a)(pt,yt,(function(n,t){return s.map((function(n){return null!=t?o.centerOnPoint(n,t.position,3):[]}),n)})),Et=e(16),bt=e.n(Et),Ot=e(13),ht=e.n(Ot),gt=e(34),wt=e.n(gt),Tt=function(n){return _.a.createElement("div",{className:wt.a.root},p.getDisplayName(n))},xt=function(n){return n?"0.5px solid black":"0.5px transparent"},kt=function(n){var t,e=n.cell,r=n.meta,i=e.walls;return _.a.createElement("div",{className:ht()(bt.a.root,(t={},Object(Dn.a)(t,bt.a.seen,r.seen),Object(Dn.a)(t,bt.a.visible,r.visible),Object(Dn.a)(t,bt.a.unknown,!r.seen&&!r.visible),t)),style:r.unknown?void 0:{borderTop:xt(i.n),borderRight:xt(i.e),borderBottom:xt(i.s),borderLeft:xt(i.w)}},T.map((function(n){return _.a.createElement(Tt,n)}),function(n){var t=n.visible,e=n.seen,r=n.occupants;return t?T.withDefault(r.find((function(n){return"player"!==n.type&&"exit"!==n.type})),r[0]):e?r.find((function(n){return"exit"===n.type})):void 0}(r)))},_t=function(){return _.a.createElement("div",{className:ht()(bt.a.empty,bt.a.root)})},St=e(24),Mt=e.n(St),At=function(n){var t=n.grid;return _.a.createElement("div",{className:Mt.a.root},t.map((function(n,t){return _.a.createElement("div",{key:t,className:Mt.a.row},n.map((function(n,t){return T.withDefault(T.map((function(n){return _.a.createElement(kt,{key:t,cell:n.cell,meta:n.meta})}),n),_.a.createElement(_t,{key:t}))})))})))},jt=e(6),Dt=e.n(jt),It=function(n){var t=n.onMove;return _.a.createElement("div",{className:Dt.a.root},_.a.createElement("div",{className:Dt.a.row},_.a.createElement("div",{className:Dt.a.block}),_.a.createElement("button",{className:ht()(Dt.a.block,Dt.a.button),onClick:function(){return t(g.Direction.NORTH)}}),_.a.createElement("div",{className:Dt.a.block})),_.a.createElement("div",{className:Dt.a.row},_.a.createElement("button",{className:ht()(Dt.a.block,Dt.a.button),onClick:function(){return t(g.Direction.WEST)}}),_.a.createElement("button",{className:ht()(Dt.a.block,Dt.a.button,Dt.a.wait),onClick:function(){return t(void 0)}}),_.a.createElement("button",{className:ht()(Dt.a.block,Dt.a.button),onClick:function(){return t(g.Direction.EAST)}})),_.a.createElement("div",{className:Dt.a.row},_.a.createElement("div",{className:Dt.a.block}),_.a.createElement("button",{className:ht()(Dt.a.block,Dt.a.button),onClick:function(){return t(g.Direction.SOUTH)}}),_.a.createElement("div",{className:Dt.a.block})))},Nt=e(35),Pt=e(36),Rt=e(39),Ut=e(37),Wt=e(40),Lt=function(n){function t(){var n,e;Object(Nt.a)(this,t);for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];return(e=Object(Rt.a)(this,(n=Object(Ut.a)(t)).call.apply(n,[this].concat(i)))).handleKeyDown=function(n){e.props.disabled||("ArrowUp"===n.key||"w"===n.key?e.props.onMove(g.Direction.NORTH):"ArrowRight"===n.key||"d"===n.key?e.props.onMove(g.Direction.EAST):"ArrowDown"===n.key||"d"===n.key?e.props.onMove(g.Direction.SOUTH):"ArrowLeft"===n.key||"a"===n.key?e.props.onMove(g.Direction.WEST):" "===n.key&&e.props.onMove(void 0))},e}return Object(Wt.a)(t,n),Object(Pt.a)(t,[{key:"componentDidMount",value:function(){window.addEventListener("keydown",this.handleKeyDown)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("keydown",this.handleKeyDown)}},{key:"render",value:function(){return k.createElement(k.Fragment,null)}}]),t}(k.PureComponent),Ht=function(n){var t=n.grid,e=n.onMove,r=n.processingUpdates;return k.createElement(k.Fragment,null,k.createElement(At,{grid:t}),k.createElement(It,{onMove:e}),k.createElement(Lt,{onMove:e,disabled:r}))};!function(n){n.REQUEST_NEW_GAME="REQUEST_NEW_GAME",n.START_NEW_GAME="START_NEW_GAME",n.REQUEST_STEP="REQUEST_STEP",n.COMPLETE_STEP="COMPLETE_STEP",n.ABORT_STEP="ABORT_STEP",n.MOVE_PLAYER="MOVE_PLAYER"}(Xn||(Xn={}));var Ct=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{type:Xn.REQUEST_NEW_GAME,options:n}},Gt=function(n,t){return{type:Xn.START_NEW_GAME,maze:n,entities:t}},zt=function(n){return{type:Xn.ABORT_STEP,stepId:n}},Bt=function(n,t){return{type:Xn.COMPLETE_STEP,stepId:n,gameData:t}},Yt=Object(N.b)((function(n){return{grid:vt(n),processingUpdates:mt(n)}}),(function(n){return{onMove:function(t){return n((e=t,{type:Xn.MOVE_PLAYER,direction:e}));var e}}}))((function(n){var t=n.grid,e=n.processingUpdates,r=n.onMove;return _.a.createElement("div",{className:I.a.root},s.isLoading(t)&&_.a.createElement("span",null,"Loading . . . "),s.isLoaded(t)&&t.data&&_.a.createElement(Ht,{processingUpdates:e,grid:t.data,onMove:r}))})),Qt=e(14),Vt=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(En.a)({game:s.loading()},n)},Ft=function(n){return Object(En.a)({},n,{game:s.loading()})},qt=function(n,t,e){return Object(En.a)({},n,{game:s.loaded(O.create(t,b.fromEntities(e,t.dimension)))})},Jt=function(n,t){return Object(En.a)({},n,{stepId:t})},Kt=function(n,t,e){return function(n,t){return s.isLoaded(t.game)?n():t}((function(){return n.stepId===t?Object(En.a)({},n,{stepId:void 0,game:s.loaded(e)}):n}),n)},Xt=function(n,t){return n.stepId===t?Object(En.a)({},n,{stepId:void 0}):n},Zt=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Vt(),t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Xn.REQUEST_STEP:return Jt(n,t.step.id);case Xn.COMPLETE_STEP:return Kt(n,t.stepId,t.gameData);case Xn.ABORT_STEP:return Xt(n,t.stepId);case Xn.START_NEW_GAME:return qt(n,t.maze,t.entities);case Xn.REQUEST_NEW_GAME:return Ft(n);default:return n}},$t=e(38),ne=e(8),te=e.n(ne),ee=e(4),re=te.a.mark(ae),ie=te.a.mark(oe);function ae(){var n,t,e,r,i,a,o,u;return te.a.wrap((function(c){for(;;)switch(c.prev=c.next){case 0:return c.prev=1,c.next=4,Object(ee.f)(Xn.REQUEST_STEP);case 4:return n=c.sent,t=n.step,c.next=8,Object(ee.d)(lt);case 8:if(e=c.sent,!s.isLoaded(e)){c.next=31;break}return r=e.data,c.next=13,Object(ee.b)(h.validateAll,t.instructions,r);case 13:if(i=c.sent,!w.isErr(i)){c.next=18;break}return c.next=17,Object(ee.c)(zt(t.id));case 17:return c.abrupt("continue",0);case 18:return a=O.generateAllAIInstructions(r),o=[].concat(Object(U.a)(a),Object(U.a)(t.instructions)),c.next=22,Object(ee.b)(h.applyAll,o,r);case 22:if(u=c.sent,!w.isErr(u)){c.next=27;break}return c.next=26,Object(ee.c)(zt(t.id));case 26:return c.abrupt("continue",0);case 27:return c.next=29,Object(ee.c)(Bt(t.id,u.data));case 29:return c.next=31,Object(ee.b)(oe,r,u.data);case 31:c.next=37;break;case 33:c.prev=33,c.t0=c.catch(1),console.warn("Error processing step"),console.error(c.t0);case 37:c.next=0;break;case 39:case"end":return c.stop()}}),re,null,[[1,33]])}function oe(n,t){var e,r;return te.a.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(e=t.entityData.entityMap[t.entityData.playerEntityId],0!==(r=b.entitiesAtPoint(t.entityData,e.position,t.maze.dimension).filter((function(n){return n.id!==e.id})).concat(b.neighborsCrossedByEntity(n.entityData,t.entityData,e.id,t.maze.dimension))).length){i.next=6;break}return i.abrupt("return");case 6:if(!r.find((function(n){return"blind-guardian"===n.type}))){i.next=12;break}return i.next=9,Object(ee.b)(window.confirm,"You've been annihilated.");case 9:window.location.reload(),i.next=16;break;case 12:if(!r.find((function(n){return"exit"===n.type}))){i.next=16;break}return i.next=15,Object(ee.b)(window.confirm,"You have escaped with your life. . . for now.");case 15:window.location.reload();case 16:case"end":return i.stop()}}),ie)}var ue=te.a.mark(ce);function ce(){return te.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,Object(ee.g)(Xn.MOVE_PLAYER,te.a.mark((function n(t){var e;return te.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,Object(ee.d)(yt);case 2:return e=n.sent,n.next=5,Object(ee.d)(mt);case 5:if(n.sent||!e){n.next=9;break}return n.next=9,Object(ee.c)((r=E.create(t.direction?h.move(e.id,t.direction):h.wait(e.id)),{type:Xn.REQUEST_STEP,step:r}));case 9:case"end":return n.stop()}var r}),n)})));case 2:case"end":return n.stop()}}),ue)}var de=te.a.mark(fe),se=T.withDefault(T.of(localStorage.getItem("name")),(function(){var n=window.prompt("What is your name?")||"";return""!==n&&localStorage.setItem("name",n),""!==n?n:"?"}));function fe(){var n,t,e,i;return te.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=1,a.next=4,Object(ee.f)(Xn.REQUEST_NEW_GAME);case 4:return n=a.sent,t=n.options,a.next=8,Object(ee.b)(r.maze,t.mazeOptions||{});case 8:return e=a.sent,i=d.fromMazeData(e),a.next=12,Object(ee.c)(Gt(i,le(i)));case 12:a.next=18;break;case 14:a.prev=14,a.t0=a.catch(1),console.warn("Error initializing new game"),console.error(a.t0);case 18:a.next=0;break;case 20:case"end":return a.stop()}}),de,null,[[1,14]])}var le=function(n){var t=n.dimension,e=l.create(se,u.pointAlongEdge(t)),r=y.create(u.randomPoint(t)),i=new Array(a.randomInRange(2,8)).fill(void 0).map((function(n){return m.create(u.randomPoint(t))}));return[e,r].concat(Object(U.a)(i))},pe=te.a.mark(ye),me=[fe,ae,ce];function ye(){return te.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,Object(ee.a)(me.map((function(n){return Object(ee.e)(n)})));case 2:return n.next=4,Object(ee.c)(Ct({mazeOptions:{dimension:u.create(15,15),algorithm:"aldous-broder"}}));case 4:case"end":return n.stop()}}),pe)}M.a.render(_.a.createElement(N.a,{store:function(){var n=Object($t.a)(),t=Object(Qt.d)(Zt,Object(Qt.a)(n));return n.run(ye),t}()},_.a.createElement("div",{className:j.a.app},_.a.createElement(Yt,null))),document.getElementById("root"))},6:function(n,t,e){n.exports={root:"GamePad_root__Lay6t",row:"GamePad_row__164Sm",block:"GamePad_block__l2_xd",button:"GamePad_button__3kDFo",wait:"GamePad_wait__5DVYu"}}},[[41,1,2]]]);
//# sourceMappingURL=main.e11160ff.chunk.js.map