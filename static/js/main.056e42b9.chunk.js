(this.webpackJsonpfollowed=this.webpackJsonpfollowed||[]).push([[0],{17:function(n,e,t){n.exports={root:"Cell_root__2ti8K",empty:"Cell_empty__1ByI9",seen:"Cell_seen__2qSTX",visible:"Cell_visible__2bnT3",unknown:"Cell_unknown__2tYkG"}},22:function(n,e,t){n.exports={root:"Grid_root__xSU_B",row:"Grid_row__1rWaL",large:"Grid_large__2_Ser"}},29:function(n,e){},30:function(n,e,t){n.exports={app:"index_app__2lpzC"}},31:function(n,e,t){n.exports={root:"App_root__ZxxJN"}},34:function(n,e,t){n.exports={root:"Entity_root__MaGTf"}},39:function(n,e,t){n.exports={root:"Chat_root__2csEn"}},43:function(n,e,t){n.exports=t(56)},56:function(n,e,t){"use strict";t.r(e);var r={};t.r(r),t.d(r,"maze",(function(){return B}));var a={};t.r(a),t.d(a,"nOf",(function(){return K})),t.d(a,"sorted",(function(){return Y})),t.d(a,"nonNull",(function(){return J})),t.d(a,"randomItem",(function(){return X}));var i={};t.r(i),t.d(i,"randomInRange",(function(){return Z}));var o={};t.r(o),t.d(o,"centerOnPoint",(function(){return $}));var c={};t.r(c),t.d(c,"getSiteSetting",(function(){return nn}));var u={};t.r(u),t.d(u,"parseQuery",(function(){return rn}));var s={};t.r(s),t.d(s,"create",(function(){return an})),t.d(s,"area",(function(){return on})),t.d(s,"randomPoint",(function(){return cn})),t.d(s,"pointAlongEdge",(function(){return un})),t.d(s,"inBounds",(function(){return sn}));var d={};t.r(d),t.d(d,"fromApi",(function(){return dn})),t.d(d,"randomDirectionalOptions",(function(){return fn}));var f={};t.r(f),t.d(f,"fromMazeData",(function(){return yn})),t.d(f,"traversableNeighbors",(function(){return vn})),t.d(f,"canWalk",(function(){return bn})),t.d(f,"canTravel",(function(){return En})),t.d(f,"lookInDirection",(function(){return On})),t.d(f,"peekableCorners",(function(){return hn})),t.d(f,"seenFromPoint",(function(){return gn})),t.d(f,"takeDeadEnd",(function(){return wn})),t.d(f,"deadEnds",(function(){return jn})),t.d(f,"placeEntitiesInDeadEnds",(function(){return Tn}));var l={};t.r(l),t.d(l,"isLoading",(function(){return xn})),t.d(l,"isLoaded",(function(){return kn})),t.d(l,"isErrored",(function(){return Mn})),t.d(l,"loading",(function(){return Sn})),t.d(l,"loaded",(function(){return Dn})),t.d(l,"errored",(function(){return An})),t.d(l,"map",(function(){return In}));var p={};t.r(p),t.d(p,"create",(function(){return Nn}));var m={};t.r(m),t.d(m,"create",(function(){return Pn})),t.d(m,"randomDisplayName",(function(){return Rn}));var y={};t.r(y),t.d(y,"EntityClass",(function(){return R}));var v={};t.r(v),t.d(v,"addEntity",(function(){return zn})),t.d(v,"fromEntities",(function(){return Ln})),t.d(v,"entitiesAtPoint",(function(){return Wn})),t.d(v,"getPlayer",(function(){return Un})),t.d(v,"byId",(function(){return Gn})),t.d(v,"byType",(function(){return Hn})),t.d(v,"moveEntity",(function(){return Fn})),t.d(v,"removeEntity",(function(){return Vn})),t.d(v,"updateEntity",(function(){return qn})),t.d(v,"entitiesCrossed",(function(){return Bn})),t.d(v,"neighborsCrossedByEntity",(function(){return Qn}));var b={};t.r(b),t.d(b,"create",(function(){return Kn})),t.d(b,"lookForEntityInDirection",(function(){return Yn})),t.d(b,"displayGrid",(function(){return Jn})),t.d(b,"generateAllAIInstructions",(function(){return Xn}));var E={};t.r(E),t.d(E,"win",(function(){return Zn})),t.d(E,"lose",(function(){return $n})),t.d(E,"play",(function(){return ne})),t.d(E,"won",(function(){return ee})),t.d(E,"lost",(function(){return te})),t.d(E,"playing",(function(){return re}));var O={};t.r(O),t.d(O,"getColor",(function(){return ae})),t.d(O,"getDescription",(function(){return ie})),t.d(O,"generateAiInstructions",(function(){return oe})),t.d(O,"onCollideWithPlayer",(function(){return ce})),t.d(O,"getKillMessage",(function(){return ue}));var h={};t.r(h),t.d(h,"create",(function(){return se})),t.d(h,"next",(function(){return de}));var g={};t.r(g),t.d(g,"create",(function(){return fe})),t.d(g,"next",(function(){return le})),t.d(g,"wander",(function(){return pe})),t.d(g,"lookForPlayerInDirection",(function(){return me}));var w={};t.r(w),t.d(w,"create",(function(){return ye}));var j={};t.r(j),t.d(j,"create",(function(){return ve})),t.d(j,"next",(function(){return be}));var T={};t.r(T),t.d(T,"create",(function(){return Ee})),t.d(T,"prioritize",(function(){return Oe})),t.d(T,"addAllToFrontier",(function(){return he})),t.d(T,"next",(function(){return ge})),t.d(T,"generateMoveInstruction",(function(){return we})),t.d(T,"calculateOptimalMove",(function(){return je}));var x={};t.r(x),t.d(x,"create",(function(){return Te})),t.d(x,"toIndex",(function(){return xe})),t.d(x,"fromIndex",(function(){return ke})),t.d(x,"neighbor",(function(){return Me})),t.d(x,"neighbors",(function(){return Se})),t.d(x,"diagonalNeighbors",(function(){return De})),t.d(x,"equals",(function(){return Ae})),t.d(x,"distance",(function(){return Ie}));var k={};t.r(k),t.d(k,"create",(function(){return _e}));var M={};t.r(M),t.d(M,"move",(function(){return Pe})),t.d(M,"update",(function(){return Ce})),t.d(M,"wait",(function(){return ze})),t.d(M,"updateGameState",(function(){return Le})),t.d(M,"see",(function(){return We})),t.d(M,"remove",(function(){return Ue})),t.d(M,"add",(function(){return Ge})),t.d(M,"validate",(function(){return He})),t.d(M,"validateAll",(function(){return Fe})),t.d(M,"apply",(function(){return Ve})),t.d(M,"applyAll",(function(){return qe}));var S={};t.r(S),t.d(S,"Direction",(function(){return Ne})),t.d(S,"all",(function(){return Qe})),t.d(S,"inverse",(function(){return Ke})),t.d(S,"random",(function(){return Ye}));var D={};t.r(D),t.d(D,"ok",(function(){return Je})),t.d(D,"err",(function(){return Xe})),t.d(D,"isErr",(function(){return Ze})),t.d(D,"isOk",(function(){return $e})),t.d(D,"map",(function(){return nt}));var A={};t.r(A),t.d(A,"of",(function(){return et})),t.d(A,"none",(function(){return tt})),t.d(A,"withDefault",(function(){return rt})),t.d(A,"map",(function(){return at})),t.d(A,"ifPresent",(function(){return it}));var I={};t.r(I),t.d(I,"create",(function(){return ct})),t.d(I,"instructions",(function(){return ut})),t.d(I,"phenomena",(function(){return st}));var _={};t.r(_),t.d(_,"create",(function(){return dt}));var N={};t.r(N),t.d(N,"create",(function(){return ft})),t.d(N,"queue",(function(){return lt})),t.d(N,"highestPrioritity",(function(){return pt})),t.d(N,"dequeue",(function(){return mt}));var P={};t.r(P),t.d(P,"create",(function(){return Ar})),t.d(P,"knowing",(function(){return Ir}));var R,C=t(1),z=t.n(C),L=t(19),W=t.n(L),U=t(30),G=t.n(U),H=t(31),F=t.n(H),V=t(18),q="https://fv9o21r19a.execute-api.us-east-1.amazonaws.com/dev",B=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=n.dimension,t=void 0===e?s.create(10,10):e,r=n.algorithm,a=void 0===r?"aldous-broder":r,i=n.corner,o=n.direction,c=fetch("".concat(q),{method:"post",mode:"cors",headers:{"content-type":"application/json"},body:JSON.stringify({dimensions:t,algorithm:a,corner:i,direction:o})});return c.then((function(n){return n.text()})).then((function(n){return d.fromApi(t,a,n)}))},Q=t(4),K=function(n,e){return new Array(n).fill(e)},Y=function(n,e){var t=Object(Q.a)(n);return t.sort(e),t},J=function(n){return n.filter((function(n){return null!=n}))},X=function(n){return n[Math.floor(Math.random()*n.length)]},Z=function(n,e){return n+Math.floor(Math.random()*(e-n-1))},$=function(n,e,t){for(var r=e.x-t,a=e.x+t+1,i=e.y-t,o=e.y+t+1,c=[],u=i;u<o;u++){for(var s=[],d=function(e){s.push(A.map((function(n){return n[e]}),n[u]))},f=r;f<a;f++)d(f);c.push(s)}return c},nn=function(n,e){return A.withDefault(window.localStorage.getItem("".concat("followed.settings",".").concat(n)),(function(){var t=e();if(t)return window.localStorage.setItem("".concat("followed.settings",".").concat(n),t),t}))},en=t(7),tn=t(2),rn=function(){return window.location.search.substring(1).split("&").reduce((function(n,e){var t=e.split("=");return Object(tn.a)({},n,Object(en.a)({},t[0],t[1]))}),{})},an=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return{width:n,height:e}},on=function(n){return n.width*n.height},cn=function(n){return x.fromIndex(Math.floor(Math.random()*on(n)),n)},un=function(n){var e=Math.random()>.5;return x.create(e?i.randomInRange(0,n.width):Math.random()>.5?0:n.width-1,e?Math.random()>.5?0:n.height-1:i.randomInRange(0,n.height))},sn=function(n,e){return e.x>=0&&e.y>=0&&e.x<n.width&&e.y<n.height},dn=function(n,e,t){return{bytes:Uint8Array.from(atob(t),(function(n){return n.charCodeAt(0)})),dimension:n,algorithm:e}},fn=function(){return{corner:a.randomItem(["nw","ne","sw","se"]),direction:a.randomItem(["n","e","s","w"])}},ln=t(21),pn=function(n){return{walls:(e={n:!((8&n)>0),s:!((4&n)>0),e:!((2&n)>0),w:!((1&n)>0)},{n:e.n||!1,e:e.e||!1,s:e.s||!1,w:e.w||!1})};var e},mn=function(n){var e=n.walls;return[e.n,e.e,e.s,e.w].filter((function(n){return!0===n})).length>=3},yn=function(n){for(var e=n.dimension,t=n.bytes,r=n.algorithm,a=[],i=[],o=0;o<e.height;o++){for(var c=[],u=0;u<e.width;u++){var s=pn(t[o*e.width+u]);c.push(s),mn(s)&&i.push(x.toIndex(x.create(u,o),e))}a.push(c)}return{grid:a,dimension:e,algorithm:r,deadends:{unused:i,used:[]}}},vn=function(n,e){return S.all().filter((function(t){return bn(n,e,t)})).map((function(n){return x.neighbor(e,n)}))},bn=function(n,e,t){var r=e.x,a=e.y;return!function(n,e){var t=n.walls;switch(e){case S.Direction.NORTH:return t.n;case S.Direction.EAST:return t.e;case S.Direction.SOUTH:return t.s;case S.Direction.WEST:return t.w}}(n.grid[a][r],t)},En=function(n,e){for(var t=arguments.length,r=new Array(t>2?t-2:0),a=2;a<t;a++)r[a-2]=arguments[a];return!!r.reduce((function(e,t){return e&&bn(n,e,t)?x.neighbor(e,t):void 0}),e)},On=function n(e,t,r,a){if(bn(e,r,t)&&a>0){var i=x.neighbor(r,t);return[i].concat(Object(Q.a)(n(e,t,i,a-1)))}return[]},hn=function(n,e){var t=[];return(En(n,e,S.Direction.NORTH,S.Direction.EAST)||En(n,e,S.Direction.EAST,S.Direction.NORTH))&&t.push(x.create(e.x+1,e.y-1)),(En(n,e,S.Direction.NORTH,S.Direction.WEST)||En(n,e,S.Direction.WEST,S.Direction.NORTH))&&t.push(x.create(e.x-1,e.y-1)),(En(n,e,S.Direction.SOUTH,S.Direction.EAST)||En(n,e,S.Direction.EAST,S.Direction.SOUTH))&&t.push(x.create(e.x+1,e.y+1)),(En(n,e,S.Direction.SOUTH,S.Direction.WEST)||En(n,e,S.Direction.WEST,S.Direction.SOUTH))&&t.push(x.create(e.x-1,e.y+1)),t},gn=function(n,e,t){return S.all().reduce((function(r,a){return r.concat(On(n,a,e,t))}),[]).concat(hn(n,e)).concat(e)},wn=function(n){var e=a.randomItem(n.deadends.unused);return e?[e,Object(tn.a)({},n,{deadends:{unused:n.deadends.unused.filter((function(n){return n!==e})),used:[].concat(Object(Q.a)(n.deadends.used),[e])}})]:[-1,n]},jn=function(n){return[].concat(Object(Q.a)(n.deadends.used),Object(Q.a)(n.deadends.unused))},Tn=function(n,e){return e.reduce((function(n,e){var t,r,a=wn(n.maze),i=Object(ln.a)(a,2),o=i[0],c=i[1];return o?(t=[].concat(Object(Q.a)(n.placed),[e(x.fromIndex(o,n.maze.dimension))]),r=Object(Q.a)(n.unplaced)):(t=Object(Q.a)(n.placed),r=[].concat(Object(Q.a)(n.unplaced),[e(x.create(-1,-1))])),{maze:c,placed:t,unplaced:r}}),{maze:n,placed:[],unplaced:[]})},xn=function(n){return"Loading"===n.state},kn=function(n){return"Loaded"===n.state},Mn=function(n){return"Errored"===n.state},Sn=function(){return{state:"Loading"}},Dn=function(n){return{state:"Loaded",data:n}},An=function(n){return{state:"Errored",e:n}},In=function(n,e){return kn(e)?Dn(n(e.data)):e},_n=t(33),Nn=function(){return Object(_n.v4)()},Pn=function(n){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:x.create(),t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:5,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Rn();return{id:p.create(),name:n,position:e,type:"player",visionRadius:t,displayName:r||n,cls:y.EntityClass.PLAYER}},Rn=function(){return a.randomItem(["\ud83d\udc15","\ud83d\udc26","\ud83d\udc08","\ud83d\udc0e","\ud83d\udc16","\ud83d\udc01","\ud83d\udc00","\ud83d\udc22"])};!function(n){n.PLAYER="PLAYER",n.INANIMATE="INANIMATE",n.HOSTILE="HOSTILE",n.ITEM="ITEM"}(R||(R={}));var Cn,zn=function(n,e,t){var r=n.entityMap,a=n.positionMap,i=n.playerEntityId,o=n.typeMap,c=x.toIndex(t.position,e);return{playerEntityId:i,positionMap:Object(tn.a)({},a,Object(en.a)({},c,a[c]?[].concat(Object(Q.a)(a[c]),[t.id]):[t.id])),entityMap:Object(tn.a)({},r,Object(en.a)({},t.id,t)),typeMap:Object(tn.a)({},o,Object(en.a)({},t.type,o[t.type]?[].concat(Object(Q.a)(o[t.type]),[t.id]):[t.id]))}},Ln=function(n,e){return{entityMap:n.reduce((function(n,e){return n[e.id]=e,n}),{}),positionMap:n.reduce((function(n,t){var r=x.toIndex(t.position,e);return n[r]=n[r]?[].concat(Object(Q.a)(n[r]),[t.id]):[t.id],n}),{}),playerEntityId:A.map((function(n){return n.id}),n.find((function(n){return"player"===n.type}))),typeMap:n.reduce((function(n,e){return Object(tn.a)({},n,Object(en.a)({},e.type,n[e.type]?[].concat(Object(Q.a)(n[e.type]),[e.id]):[e.id]))}),{})}},Wn=function(n,e,t){var r=x.toIndex(e,t);return(n.positionMap[r]||[]).map((function(e){return n.entityMap[e]}))},Un=function(n){return A.map((function(e){return n.entityMap[e]}),n.playerEntityId)},Gn=function(n,e){return n.entityMap[e]},Hn=function(n,e){return a.nonNull(n.typeMap[e]||[]).map((function(e){return n.entityMap[e]}))},Fn=function(n,e,t,r){var a=e.entityMap[n];if(null!=a){var i,o=x.toIndex(a.position,r),c=x.toIndex(t,r),u=Object(tn.a)({},a,{position:t});return Object(tn.a)({},e,{entityMap:Object(tn.a)({},e.entityMap,Object(en.a)({},n,u)),positionMap:Object(tn.a)({},e.positionMap,(i={},Object(en.a)(i,o,Object(Q.a)((e.positionMap[o]||[]).filter((function(e){return e!==n})))),Object(en.a)(i,c,[].concat(Object(Q.a)(e.positionMap[c]||[]),[n])),i))})}return e},Vn=function(n,e,t){var r=e.entityMap[n],a=x.toIndex(r.position,t);return Object(tn.a)({},e,{entityMap:Object.keys(e.entityMap).reduce((function(t,r){return r!==n&&(t[r]=e.entityMap[r]),t}),{}),typeMap:Object.keys(e.typeMap).reduce((function(t,a){return a===r.type?t[a]=e.typeMap[a].filter((function(e){return e!==n})):t[a]=e.typeMap[a],t}),{}),positionMap:Object.keys(e.positionMap).map((function(n){return parseInt(n)})).reduce((function(t,r){return t[r]=r===a?e.positionMap[r].filter((function(e){return e!==n})):e.positionMap[r],t}),{})})},qn=function(n,e){return Object(tn.a)({},e,{entityMap:Object(tn.a)({},e.entityMap,Object(en.a)({},n.id,n))})},Bn=function(n,e,t,r){var a=n.entityMap[t],i=n.entityMap[r],o=e.entityMap[t],c=e.entityMap[r];return x.equals(o.position,i.position)&&x.equals(c.position,a.position)},Qn=function(n,e,t,r){return x.neighbors(e.entityMap[t].position,r).map((function(n){return x.toIndex(n,r)})).reduce((function(n,t){return n.concat(e.positionMap[t]||[])}),[]).filter((function(r){return Bn(n,e,t,r)})).map((function(n){return e.entityMap[n]}))},Kn=function(n,e){var t=v.getPlayer(e),r=new Set(t?f.seenFromPoint(n,t.position,t.visionRadius).map((function(e){return x.toIndex(e,n.dimension)})):[]);return{maze:n,entityData:e,seen:new Set,sees:r,stepCount:0,state:E.play()}},Yn=function(n,e,t,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:5;return f.lookInDirection(t.maze,n,e,a).reduce((function(n,e){return n||null!=v.entitiesAtPoint(t.entityData,e,t.maze.dimension).find(r)}),!1)},Jn=function(n){var e=n.maze,t=n.entityData,r=n.seen,a=n.sees;return e.grid.reduce((function(n,i,o){return[].concat(Object(Q.a)(n),[i.reduce((function(n,i,c){var u=x.create(c,o),s=r.has(x.toIndex(u,e.dimension)),d=a.has(x.toIndex(u,e.dimension));return n.concat({cell:i,meta:{occupants:v.entitiesAtPoint(t,x.create(c,o),e.dimension),visible:d,seen:s,unknown:!d&&!s}})}),[])])}),[])},Xn=function(n){return Object.keys(n.entityData.entityMap).map((function(e){return v.byId(n.entityData,e)})).filter((function(n){return"player"!==n.type})).reduce((function(e,t){return e.concat(O.generateAiInstructions(t,n))}),[])},Zn=function(){return{type:"Won"}},$n=function(n){return{type:"Lost",causeOfDeath:n}},ne=function(){return{type:"Playing"}},ee=function(n){return"Won"===n.type},te=function(n){return"Lost"===n.type},re=function(n){return"Playing"===n.type},ae=function(n){return n.type,"transparent"},ie=function(n){switch(n.type){case"player":return n.name;case"blind-guardian":return"a blind guardian";case"exit":return"an exit";case"wandering-husk":return"a wandering husk";case"orb-of-knowing":return"a mysterious, translucent orb";case"sinister-dolls":return"two lifelike dolls";case"seeker":return"the seeker"}},oe=function(n,e){switch(n.type){case"blind-guardian":return h.next(n,e);case"wandering-husk":return g.next(n,e);case"sinister-dolls":return j.next(n,e);case"seeker":return T.next(n,e);default:return[]}},ce=function(n,e){return n.cls===R.HOSTILE?I.create([M.updateGameState(E.lose({entityId:n.id}))]):n.cls===R.ITEM?I.create(void 0,[n.phenomena]):"exit"===n.type?I.create([M.updateGameState(E.win())]):I.create()},ue=function(n,e){switch(e.type){case"blind-guardian":return"".concat(n.name," has been annihilated by ").concat(ie(e),". Nothing is left.");case"wandering-husk":return"Blood and sinew cling to the maw of the wandering husk. ".concat(n.name," has been consumed.");case"sinister-dolls":return"The dolls draw closer. ".concat(n.name," is frozen. Then, darkness. ").concat(n.name," is never heard from again.");default:return"".concat(n.name," was killed by ").concat(ie(e))}},se=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:x.create();return{type:"blind-guardian",position:n,id:p.create(),heading:S.Direction.NORTH,cls:y.EntityClass.HOSTILE}},de=function(n,e){var t,r=S.all().filter((function(t){return f.canWalk(e.maze,n.position,t)})),i=r.filter((function(e){return e!==S.inverse(n.heading)}));return t=r.includes(n.heading)&&Math.random()<.75?n.heading:Math.random()<.75&&i.length>0?a.randomItem(i):r[0],[M.update(Object(tn.a)({},n,{heading:t})),M.move(n.id,t)]},fe=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:x.create();return{type:"wandering-husk",position:n,id:p.create(),heading:S.random(),cls:y.EntityClass.HOSTILE}},le=function(n,e){var t,r=S.all().reduce((function(t,r){return t||(me(r,n.position,e)?r:void 0)}),void 0),a=[];return r?Math.random()<.9?(t=r,a.push(M.move(n.id,t))):(t=n.heading,a.push(M.wait(n.id))):(t=pe(n,e),a.push(M.move(n.id,t))),[M.update(Object(tn.a)({},n,{heading:t}))].concat(a)},pe=function(n,e){var t=S.all().filter((function(t){return f.canWalk(e.maze,n.position,t)})),r=t.filter((function(e){return e!==S.inverse(n.heading)}));return t.includes(n.heading)&&Math.random()<.75?n.heading:Math.random()<.75&&r.length>0?a.randomItem(r):t[0]},me=function(n,e,t){return f.lookInDirection(t.maze,n,e,5).reduce((function(n,e){return n||null!=v.entitiesAtPoint(t.entityData,e,t.maze.dimension).find((function(n){return"player"===n.type}))}),!1)},ye=function(n){return{position:n,id:p.create(),type:"exit",cls:y.EntityClass.INANIMATE}},ve=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:x.create();return{type:"sinister-dolls",position:n,id:p.create(),cls:y.EntityClass.HOSTILE}},be=function(n,e){var t=S.all().reduce((function(t,r){return t||(Yn(r,n.position,e,(function(n){return"player"===n.type}))?r:void 0)}),void 0);return t&&Math.random()<.9?[M.move(n.id,t)]:[]},Ee=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:x.create();return{type:"seeker",position:n,id:p.create(),cls:y.EntityClass.HOSTILE,steps:0}},Oe=function(n,e){return Math.round(x.distance(n,e))},he=function(n,e,t){return e.reduce((function(n,e){return N.queue(n,e,Oe(e,t))}),n)},ge=function(n,e){var t=[M.update(Object(tn.a)({},n,{steps:n.steps+1}))];if(n.steps<15&&n.steps%3===0||n.steps>=15&&n.steps<30&&n.steps%2===0||n.steps>30){var r=we(n,e);null!=r&&(console.log("moving "+r.payload.direction+" (".concat(n.position.x,", ").concat(n.position.y,")")),t.push(r))}else console.log("passing "+n.steps);return t},we=function(n,e){var t=v.getPlayer(e.entityData).position,r=n.position,a=e.maze.dimension,i=new Map;i.set(x.toIndex(r,a),void 0);for(var o=A.none(),c=he(N.create(),[r],t),u=function(){var n=N.dequeue(c,Math.min,x.equals),u=n.queue,s=n.item;if(!s)return o=A.none(),"break";var d=f.traversableNeighbors(e.maze,s).filter((function(n){return!i.has(x.toIndex(n,a))}));d.forEach((function(n){return i.set(x.toIndex(n,a),s)}));var l=d.filter((function(n){return x.equals(n,t)}));if(l.length>0)return o=je(l[0],r,i,a),"break";c=he(u,d,t)};;){if("break"===u())break}var s=A.map((function(n){return A.of(S.all().find((function(e){return x.equals(n,x.neighbor(r,e))})))}),o);return A.map((function(e){return M.move(n.id,e)}),s)},je=function(n,e,t,r){for(var a=n;;){var i=t.get(x.toIndex(a,r));if(i==e||void 0==i)return a;a=i}},Te=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return{x:n,y:e}},xe=function(n,e){var t=n.x;return n.y*e.width+t},ke=function(n,e){var t=e.width;return Te(n%t,Math.floor(n/t))},Me=function(n,e){switch(e){case"NORTH":return x.create(n.x,n.y-1);case"SOUTH":return x.create(n.x,n.y+1);case"EAST":return x.create(n.x+1,n.y);case"WEST":default:return x.create(n.x-1,n.y)}},Se=function(n,e){return S.all().map((function(e){return Me(n,e)})).filter((function(n){return s.inBounds(e,n)}))},De=function(n,e){return[Te(n.x-1,n.y-1),Te(n.x+1,n.y-1),Te(n.x+1,n.y+1),Te(n.x-1,n.y+1)].filter((function(n){return s.inBounds(e,n)}))},Ae=function(n,e){return n.x===e.x&&n.y===e.y},Ie=function(n,e){return Math.sqrt(Math.pow(n.x-e.x,2)+Math.pow(n.y-e.y,2))},_e=function(){for(var n=arguments.length,e=new Array(n),t=0;t<n;t++)e[t]=arguments[t];return{instructions:e,id:p.create()}};!function(n){n.MOVE="MOVE",n.UPDATE="UPDATE",n.WAIT="WAIT",n.UPDATE_GAME_STATE="UPDATE_GAME_STATE",n.SEE="SEE",n.REMOVE="REMOVE",n.ADD="ADD"}(Cn||(Cn={}));var Ne,Pe=function(n,e){return{type:Cn.MOVE,payload:{entityId:n,direction:e}}},Re=function(n,e,t){var r=new Set(f.seenFromPoint(t,e.position,e.visionRadius).map((function(n){return x.toIndex(n,t.dimension)})));return{sees:r,seen:new Set([].concat(Object(Q.a)(n),Object(Q.a)(r)))}},Ce=function(n){return{type:Cn.UPDATE,payload:{updated:n}}},ze=function(n){return{type:Cn.WAIT,payload:{entityId:n}}},Le=function(n){return{type:Cn.UPDATE_GAME_STATE,payload:{updated:n}}},We=function(n){return{type:Cn.SEE,payload:n}},Ue=function(n){return{type:Cn.REMOVE,payload:n}},Ge=function(){for(var n=arguments.length,e=new Array(n),t=0;t<n;t++)e[t]=arguments[t];return{type:Cn.ADD,payload:{entities:e}}},He=function(n,e){switch(n.type){case Cn.MOVE:return function(n,e){var t=n.payload;return f.canWalk(e.maze,e.entityData.entityMap[t.entityId].position,t.direction)?D.ok(void 0):D.err("way is blocked")}(n,e);case Cn.WAIT:return D.ok(void 0);default:return D.err("Unkown instruction of type ".concat(n.type))}},Fe=function(n,e){return n.reduce((function(n,t){return D.isOk(n)?He(t,e):n}),D.ok(void 0))},Ve=function(n,e){try{switch(n.type){case Cn.MOVE:return D.ok(function(n,e){var t=n.payload,r=t.entityId,a=t.direction,i=v.moveEntity(r,e.entityData,x.neighbor(e.entityData.entityMap[r].position,a),e.maze.dimension),o=v.getPlayer(i),c=o&&r===o.id?Re(e.seen,o,e.maze):e,u=c.seen,s=c.sees;return Object(tn.a)({},e,{seen:u,sees:s,entityData:i})}(n,e));case Cn.UPDATE:return D.ok(function(n,e){return Object(tn.a)({},e,{entityData:v.updateEntity(n.payload.updated,e.entityData)})}(n,e));case Cn.WAIT:return D.ok(function(n,e){return Object(tn.a)({},e)}(0,e));case Cn.UPDATE_GAME_STATE:return D.ok(function(n,e){return Object(tn.a)({},e,{state:E.lost(e.state)?e.state:n.payload.updated})}(n,e));case Cn.SEE:return D.ok(function(n,e){return Object(tn.a)({},e,{seen:new Set([].concat(Object(Q.a)(e.seen),Object(Q.a)(n.payload)))})}(n,e));case Cn.REMOVE:return D.ok(function(n,e){return Object(tn.a)({},e,{entityData:v.removeEntity(n.payload,e.entityData,e.maze.dimension)})}(n,e));case Cn.ADD:return D.ok(function(n,e){return Object(tn.a)({},e,{entityData:n.payload.entities.reduce((function(n,t){return v.addEntity(n,e.maze.dimension,t)}),e.entityData)})}(n,e))}}catch(t){return console.warn("Error applying instruction",n),console.error(t),D.err("Error applying instructions")}},qe=function(n,e){return n.reduce((function(n,e){return D.isOk(n)?Ve(e,n.data):n}),D.ok(e))};!function(n){n.NORTH="NORTH",n.SOUTH="SOUTH",n.EAST="EAST",n.WEST="WEST"}(Ne||(Ne={}));var Be,Qe=function(){return[Ne.NORTH,Ne.SOUTH,Ne.EAST,Ne.WEST]},Ke=function(n){switch(n){case Ne.NORTH:return Ne.SOUTH;case Ne.SOUTH:return Ne.NORTH;case Ne.EAST:return Ne.WEST;case Ne.WEST:return Ne.EAST}},Ye=function(){return X(Qe())},Je=function(n){return{type:"Ok",data:n}},Xe=function(n){return{type:"Error",msg:n}},Ze=function(n){return"Error"===n.type},$e=function(n){return"Ok"===n.type},nt=function(n,e){return $e(e)?Je(n(e.data)):e},et=(t(29),function(n){return n}),tt=function(){},rt=function(n,e){return null!=n?n:"function"===typeof e?e():e},at=function(n,e){return null!=e?n(e):void 0},it=function(n,e){null!=e&&n(e)};!function(n){n[n.FORGETTING=0]="FORGETTING",n.KNOW_DOOR_LOCATION="KNOW_DOOR_LOCATION"}(Be||(Be={}));var ot,ct=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return{instructions:n,phenomena:e}},ut=function(n){return n.reduce((function(n,e){return[].concat(Object(Q.a)(n),Object(Q.a)(e.instructions))}),[])},st=function(n){return n.reduce((function(n,e){return[].concat(Object(Q.a)(n),Object(Q.a)(e.phenomena))}),[])},dt=function(n,e){return{message:n,speaker:e}},ft=function(){return{}},lt=function(n,e,t){return Object(tn.a)({},n,Object(en.a)({},t,n[t]?[].concat(Object(Q.a)(n[t]),[e]):[e]))},pt=function(n,e){var t=Object.keys(n).map((function(n){return n})).filter((function(e){return null!=n[e]&&n[e].length>0})),r=e.apply(void 0,Object(Q.a)(t));if(r!==1/0)return r;console.log({msg:"wtf",priorities:t,highest:r,keys:Object.keys(n),queue:n})},mt=function(n){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Math.max,t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(n,e){return n===e},r=pt(n,e);if(r){var a=n[r][0],i=n[r].filter((function(n){return!t(a,n)}));return{queue:Object(tn.a)({},n,Object(en.a)({},r,i)),item:A.of(a)}}return{queue:n,item:A.none()}},yt=t(16),vt=function(n){return n},bt=Object(yt.a)(vt,(function(n){return n.game})),Et=Object(yt.a)(bt,(function(n){return l.map(b.displayGrid,n)})),Ot=Object(yt.a)(vt,(function(n){return null!=n.stepId})),ht=Object(yt.a)(bt,(function(n){return l.isLoaded(n)?A.map((function(e){return n.data.entityData.entityMap[e]}),n.data.entityData.playerEntityId):void 0})),gt=Object(yt.a)(Et,ht,(function(n,e){return l.map((function(n){return null!=e?o.centerOnPoint(n,e.position,3):[]}),n)})),wt=Object(yt.a)(vt,(function(n){return n.chat.messages})),jt=t(17),Tt=t.n(jt),xt=t(14),kt=t.n(xt),Mt=t(34),St=t.n(Mt),Dt=function(n){return z.a.createElement("div",{className:St.a.root,style:{color:(e=n,"player"===e.type?"black":"exit"===e.type||"orb-of-knowing"===e.type?"blue":"red")}},function(n){switch(n.type){case"player":return n.name[0].toUpperCase();case"sinister-dolls":return"D";case"wandering-husk":return"H";case"blind-guardian":return"G";case"orb-of-knowing":return"O";case"exit":return"E";default:return"S "}}(n));var e},At=function(n){return n?"4px solid #444444":"4px solid transparent"},It=function(n){var e,t=n.cell,r=n.meta,a=t.walls;return z.a.createElement("div",{className:kt()(Tt.a.root,(e={},Object(en.a)(e,Tt.a.seen,r.seen),Object(en.a)(e,Tt.a.visible,r.visible),Object(en.a)(e,Tt.a.unknown,!r.seen&&!r.visible),e)),style:r.unknown?void 0:{borderTop:At(a.n),borderRight:At(a.e),borderBottom:At(a.s),borderLeft:At(a.w)}},A.map((function(n){return z.a.createElement(Dt,n)}),function(n){var e=n.visible,t=n.seen,r=n.occupants;return e?A.withDefault(r.find((function(n){return"player"!==n.type&&"exit"!==n.type})),r[0]):t?r.find((function(n){return"exit"===n.type})):void 0}(r)))},_t=function(){return z.a.createElement("div",{className:kt()(Tt.a.empty,Tt.a.root)})},Nt=t(22),Pt=t.n(Nt),Rt=function(n){var e=n.grid,t=n.largeScreen;return z.a.createElement("div",{className:kt()(Pt.a.root,Object(en.a)({},Pt.a.large,t))},e.map((function(n,e){return z.a.createElement("div",{key:e,className:Pt.a.row},n.map((function(n,e){return A.withDefault(A.map((function(n){return z.a.createElement(It,{key:e,cell:n.cell,meta:n.meta})}),n),z.a.createElement(_t,{key:e}))})))})))},Ct=t(9),zt=t.n(Ct),Lt=function(n){var e=n.onMove;return z.a.createElement("div",{className:zt.a.root},z.a.createElement("div",{className:zt.a.row},z.a.createElement("div",{className:zt.a.block}),z.a.createElement("div",{className:zt.a.block},z.a.createElement("button",{className:zt.a.button,onClick:function(){return e(S.Direction.NORTH)}})),z.a.createElement("div",{className:zt.a.block})),z.a.createElement("div",{className:zt.a.row},z.a.createElement("div",{className:zt.a.block},z.a.createElement("button",{className:zt.a.button,onClick:function(){return e(S.Direction.WEST)}})),z.a.createElement("div",{className:zt.a.block},z.a.createElement("button",{className:kt()(zt.a.button,zt.a.wait),onClick:function(){return e(void 0)}})),z.a.createElement("div",{className:zt.a.block},z.a.createElement("button",{className:zt.a.button,onClick:function(){return e(S.Direction.EAST)}}))),z.a.createElement("div",{className:zt.a.row},z.a.createElement("div",{className:zt.a.block}),z.a.createElement("div",{className:zt.a.block},z.a.createElement("button",{className:zt.a.button,onClick:function(){return e(S.Direction.SOUTH)}})),z.a.createElement("div",{className:zt.a.block})))},Wt=t(35),Ut=t(36),Gt=t(41),Ht=t(37),Ft=t(42),Vt=function(n){function e(){var n,t;Object(Wt.a)(this,e);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(t=Object(Gt.a)(this,(n=Object(Ht.a)(e)).call.apply(n,[this].concat(a)))).handleKeyDown=function(n){t.props.disabled||("ArrowUp"===n.key||"w"===n.key?t.props.onMove(S.Direction.NORTH):"ArrowRight"===n.key||"d"===n.key?t.props.onMove(S.Direction.EAST):"ArrowDown"===n.key||"d"===n.key?t.props.onMove(S.Direction.SOUTH):"ArrowLeft"===n.key||"a"===n.key?t.props.onMove(S.Direction.WEST):" "!==n.key&&"Enter"!==n.key||t.props.onMove(void 0))},t}return Object(Ft.a)(e,n),Object(Ut.a)(e,[{key:"componentDidMount",value:function(){window.addEventListener("keydown",this.handleKeyDown)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("keydown",this.handleKeyDown)}},{key:"render",value:function(){return C.createElement(C.Fragment,null)}}]),e}(C.PureComponent),qt=t(38),Bt=t.n(qt),Qt=t(39),Kt=t.n(Qt),Yt=function(n){var e=n.messages;return z.a.createElement("div",{className:Kt.a.root},e.map((function(n,e){return z.a.createElement("div",{key:e},n.message)})))},Jt=function(n){var e=n.grid,t=n.onMove,r=n.processingUpdates,a=n.messages;return C.createElement(Bt.a,{minWidth:1024},(function(n){return C.createElement(C.Fragment,null,C.createElement(Yt,{messages:a}),C.createElement(Rt,{grid:e,largeScreen:n}),!n&&C.createElement(Lt,{onMove:t}),C.createElement(Vt,{onMove:t,disabled:r}))}))};!function(n){n.REQUEST_NEW_GAME="REQUEST_NEW_GAME",n.START_NEW_GAME="START_NEW_GAME",n.REQUEST_STEP="REQUEST_STEP",n.PROCESS_STEP="PROCESS_STEP",n.COMPLETE_STEP="COMPLETE_STEP",n.ABORT_STEP="ABORT_STEP",n.MOVE_PLAYER="MOVE_PLAYER",n.ADD_MESSAGE="ADD_MESSAGE"}(ot||(ot={}));var Xt,Zt=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{type:ot.REQUEST_NEW_GAME,options:n}},$t=function(n,e){return{type:ot.START_NEW_GAME,maze:n,entities:e}},nr=function(n){return{type:ot.ABORT_STEP,stepId:n}},er=function(n,e){return{type:ot.PROCESS_STEP,stepId:n,gameData:e}},tr="true"===c.getSiteSetting("devmode",(function(){var n=u.parseQuery().devmode;return n&&"false"!==n?"true":void 0}));fetch("".concat(window.location.href.substring(0,window.location.href.indexOf("?")),"/VERSION")).then((function(n){return n.text().then((function(n){return Xt=n}))}));var rr=Object(V.b)((function(n){return{gameData:bt(n)}}))((function(n){var e=n.gameData;return tr&&l.isLoaded(e)?z.a.createElement("button",{onFocus:function(n){return n.preventDefault()},style:{position:"absolute",top:5,left:5},onClick:function(){window.alert(function(n){return["maze algorithm:: ".concat(n.maze.algorithm),"maze dimensions:: ".concat(n.maze.dimension.width," x ").concat(n.maze.dimension.height),"entityCount:: ".concat((e=n.entityData,"\n\t"+Object.keys(e.typeMap).map((function(n){return"".concat(n,": ").concat(e.typeMap[n].length)})).join("\n\t"))),"step:: ".concat(n.stepCount),"version:: ".concat(Xt)].join("\n");var e}(e.data)),A.ifPresent((function(n){return n.blur()}),document.activeElement)}},"?"):z.a.createElement(z.a.Fragment,null)})),ar=Object(V.b)((function(n){return{grid:gt(n),processingUpdates:Ot(n),messages:wt(n)}}),(function(n){return{onMove:function(e){return n((t=e,{type:ot.MOVE_PLAYER,direction:t}));var t}}}))((function(n){var e=n.grid,t=n.processingUpdates,r=n.messages,a=n.onMove;return z.a.createElement("div",{className:F.a.root},l.isLoading(e)&&z.a.createElement("span",null,"Loading . . . "),l.isLoaded(e)&&e.data&&z.a.createElement(z.a.Fragment,null,z.a.createElement(rr,null),z.a.createElement(Jt,{processingUpdates:t,grid:e.data,onMove:a,messages:r})))})),ir=t(13),or=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(tn.a)({game:l.loading(),chat:{messages:[],roundsSince:0}},n)},cr=function(n){return Object(tn.a)({},n,{game:l.loading()})},ur=function(n,e,t){return Object(tn.a)({},n,{game:l.loaded(b.create(e,v.fromEntities(t,e.dimension)))})},sr=function(n,e){return l.isLoaded(e.game)?n():e},dr=function(n,e){return Object(tn.a)({},n,{stepId:e})},fr=function(n,e,t){return sr((function(){return n.stepId===e?Object(tn.a)({},n,{game:l.loaded(t)}):n}),n)},lr=function(n,e){return sr((function(){return n.stepId===e?Object(tn.a)({},n,{stepId:void 0,game:l.map((function(n){return Object(tn.a)({},n,{stepCount:n.stepCount+1})}),n.game),chat:Object(tn.a)({},n.chat,{messages:[_.create("")].concat(Object(Q.a)(n.chat.messages)).slice(0,5),roundsSince:n.chat.roundsSince+=1})}):n}),n)},pr=function(n,e){return n.stepId===e?Object(tn.a)({},n,{stepId:void 0}):n},mr=function(n,e){return Object(tn.a)({},n,{chat:{messages:[e].concat(Object(Q.a)(n.chat.messages)).slice(0,5),roundsSince:0}})},yr=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:or(),e=arguments.length>1?arguments[1]:void 0;switch(e.type){case ot.REQUEST_STEP:return dr(n,e.step.id);case ot.COMPLETE_STEP:return lr(n,e.stepId);case ot.ABORT_STEP:return pr(n,e.stepId);case ot.PROCESS_STEP:return fr(n,e.stepId,e.gameData);case ot.START_NEW_GAME:return ur(n,e.maze,e.entities);case ot.REQUEST_NEW_GAME:return cr(n);case ot.ADD_MESSAGE:return mr(n,e.message);default:return n}},vr=t(40),br=t(8),Er=t.n(br),Or=t(6),hr=Er.a.mark(jr),gr=Er.a.mark(xr),wr=Er.a.mark(kr);function jr(){var n,e,t,r,a,i,o,c,u,s,d,f,p;return Er.a.wrap((function(m){for(;;)switch(m.prev=m.next){case 0:n=[];case 1:return m.prev=2,m.next=5,Object(Or.f)(ot.REQUEST_STEP);case 5:return e=m.sent,t=e.step,m.next=9,Object(Or.d)(bt);case 9:if(r=m.sent,!l.isLoaded(r)){m.next=58;break}return a=r.data,m.next=14,Object(Or.b)(M.validateAll,t.instructions,a);case 14:if(i=m.sent,!D.isErr(i)){m.next=19;break}return m.next=18,Object(Or.c)(nr(t.id));case 18:return m.abrupt("continue",1);case 19:return o=b.generateAllAIInstructions(a),c=[].concat(Object(Q.a)(o),Object(Q.a)(t.instructions)),m.next=23,Object(Or.b)(M.applyAll,c,a);case 23:if(u=m.sent,!D.isErr(u)){m.next=28;break}return m.next=27,Object(Or.c)(nr(t.id));case 27:return m.abrupt("continue",1);case 28:return m.next=30,Object(Or.b)(Tr,a,u.data);case 30:return s=m.sent,m.next=33,Object(Or.b)(M.applyAll,s.reduce((function(n,e){return[].concat(Object(Q.a)(n),Object(Q.a)(e.instructions))}),[]),u.data);case 33:if(d=m.sent,!D.isErr(d)){m.next=38;break}return m.next=37,Object(Or.c)(nr(t.id));case 37:return m.abrupt("continue",1);case 38:return n=n.concat(I.phenomena(s)),m.next=41,Object(Or.b)(xr,n,a);case 41:return f=m.sent,m.next=44,Object(Or.b)(M.applyAll,f,d.data);case 44:if(p=m.sent,!D.isErr(p)){m.next=49;break}return m.next=48,Object(Or.c)(nr(t.id));case 48:return m.abrupt("continue",1);case 49:return m.next=51,Object(Or.b)(Mr,n);case 51:return n=m.sent,m.next=54,Object(Or.c)(er(t.id,p.data));case 54:return m.next=56,Object(Or.b)(kr,p.data);case 56:return m.next=58,Object(Or.c)((y=t.id,{type:ot.COMPLETE_STEP,stepId:y}));case 58:m.next=64;break;case 60:m.prev=60,m.t0=m.catch(2),console.warn("Error processing step"),console.error(m.t0);case 64:m.next=1;break;case 66:case"end":return m.stop()}var y}),hr,null,[[2,60]])}var Tr=function(n,e){var t=v.getPlayer(e.entityData);return v.entitiesAtPoint(e.entityData,t.position,e.maze.dimension).filter((function(n){return n.id!==t.id})).concat(v.neighborsCrossedByEntity(n.entityData,e.entityData,t.id,e.maze.dimension)).map((function(n){return O.onCollideWithPlayer(n,e)}))};function xr(n,e){var t,r,a,i,o,c,u,s;return Er.a.wrap((function(d){for(;;)switch(d.prev=d.next){case 0:t=[],r=!0,a=!1,i=void 0,d.prev=4,o=n[Symbol.iterator]();case 6:if(r=(c=o.next()).done){d.next=15;break}return u=c.value,d.next=10,Object(Or.b)(u.fn,e);case 10:s=d.sent,t=t.concat(s);case 12:r=!0,d.next=6;break;case 15:d.next=21;break;case 17:d.prev=17,d.t0=d.catch(4),a=!0,i=d.t0;case 21:d.prev=21,d.prev=22,r||null==o.return||o.return();case 24:if(d.prev=24,!a){d.next=27;break}throw i;case 27:return d.finish(24);case 28:return d.finish(21);case 29:return d.abrupt("return",t);case 30:case"end":return d.stop()}}),gr,null,[[4,17,21,29],[22,,24,28]])}function kr(n){var e,t,r;return Er.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(e=n.state,t=n.entityData,r=v.getPlayer(t),!E.lost(e)){a.next=8;break}return a.next=5,Object(Or.b)(window.confirm,O.getKillMessage(v.getPlayer(t),v.byId(t,e.causeOfDeath.entityId)));case 5:window.location.reload(),a.next=12;break;case 8:if(!E.won(e)){a.next=12;break}return a.next=11,Object(Or.b)(window.confirm,"".concat(r.name," escaped. . . this time."));case 11:window.location.reload();case 12:case"end":return a.stop()}}),wr)}var Mr=function(n){return n.map((function(n){return Object(tn.a)({},n,{duration:"FOREVER"!==n.duration?n.duration-1:n.duration})})).filter((function(n){return"FOREVER"===n.duration||n.duration>0}))},Sr=Er.a.mark(Dr);function Dr(){return Er.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,Object(Or.g)(ot.MOVE_PLAYER,Er.a.mark((function n(e){var t;return Er.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,Object(Or.d)(ht);case 2:return t=n.sent,n.next=5,Object(Or.d)(Ot);case 5:if(n.sent||!t){n.next=9;break}return n.next=9,Object(Or.c)((r=k.create(e.direction?M.move(t.id,e.direction):M.wait(t.id)),{type:ot.REQUEST_STEP,step:r}));case 9:case"end":return n.stop()}var r}),n)})));case 2:case"end":return n.stop()}}),Sr)}var Ar=function(n){var e=function(n){return{id:p.create(),cls:R.ITEM,position:n}}(n);return Object(tn.a)({},e,{type:"orb-of-knowing",phenomena:Ir(e.id),instruction:[]})},Ir=function(n){return{name:Be.KNOW_DOOR_LOCATION,duration:1,fn:function(e){return alert("You feel enlightened by the forces of providence.\nFor in thine posession is the Orb of Knowing."),alert("Something has entered the maze."),[].concat(Object(Q.a)(Hn(e.entityData,"exit").map((function(n){return n})).map((function(n){return xe(n.position,e.maze.dimension)})).map((function(n){return We([n])}))),[Ge(T.create(ke(a.randomItem(e.maze.deadends.unused),e.maze.dimension))),Ue(n)])}}},_r=Er.a.mark(Rr),Nr=Er.a.mark(Cr),Pr=A.withDefault(A.of(localStorage.getItem("name")),(function(){var n=window.prompt("What is your name?")||"";return""!==n&&localStorage.setItem("name",n),""!==n?n:"?"}));function Rr(){return Er.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,Object(Or.c)(Zt({mazeOptions:Object(tn.a)({dimension:a.randomItem([s.create(10,10),s.create(15,15),s.create(15,15),s.create(15,15),s.create(15,15),s.create(20,20),s.create(25,10),s.create(10,25),s.create(20,15),s.create(15,20),s.create(30,5),s.create(5,30)]),algorithm:a.randomItem(["aldous-broder","aldous-broder","aldous-broder","binary-tree","side-winder"])},d.randomDirectionalOptions())}));case 2:case"end":return n.stop()}}),_r)}function Cr(){var n,e,t,a,i,o,c,u;return Er.a.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:return s.prev=1,s.next=4,Object(Or.f)(ot.REQUEST_NEW_GAME);case 4:return n=s.sent,e=n.options,s.next=8,Object(Or.b)(r.maze,e.mazeOptions||{});case 8:return t=s.sent,a=f.fromMazeData(t),i=zr(a),o=Object(ln.a)(i,2),c=o[0],u=o[1],s.next=13,Object(Or.c)($t(c,u));case 13:return s.next=15,Object(Or.c)((d=_.create("The game is afoot."),{type:ot.ADD_MESSAGE,message:d}));case 15:s.next=21;break;case 17:s.prev=17,s.t0=s.catch(1),console.warn("Error initializing new game"),console.error(s.t0);case 21:s.next=0;break;case 23:case"end":return s.stop()}var d}),Nr,null,[[1,17]])}var zr=function(n){var e=n.dimension,t=m.create(Pr,s.pointAlongEdge(e)),r=new Array(i.randomInRange(1,5)).fill(void 0).map((function(n){return h.create(s.randomPoint(e))})),o=new Array(a.randomItem([1,1,2,2,3])).fill(void 0).map((function(n){return g.create(s.randomPoint(e))})),c=[].concat(Object(Q.a)(r),Object(Q.a)(o)),u=f.placeEntitiesInDeadEnds(n,[w.create,P.create,j.create,j.create]),d=u.placed,l=u.maze,p=u.unplaced;return p.length>0&&console.log("Ran out of deadends to place these entities ".concat(p.map((function(n){return n.type})).join(", "))),[l,[t].concat(Object(Q.a)(c),Object(Q.a)(d))]},Lr=Er.a.mark(Ur),Wr=[Rr,Cr,jr,Dr];function Ur(){return Er.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,Object(Or.a)(Wr.map((function(n){return Object(Or.e)(n)})));case 2:case"end":return n.stop()}}),Lr)}W.a.render(z.a.createElement(V.a,{store:function(){var n=Object(vr.a)(),e=Object(ir.d)(yr,Object(ir.a)(n));return n.run(Ur),e}()},z.a.createElement("div",{className:G.a.app},z.a.createElement(ar,null))),document.getElementById("root"))},9:function(n,e,t){n.exports={root:"GamePad_root__Lay6t",row:"GamePad_row__164Sm",block:"GamePad_block__l2_xd",button:"GamePad_button__3kDFo",wait:"GamePad_wait__5DVYu"}}},[[43,1,2]]]);
//# sourceMappingURL=main.056e42b9.chunk.js.map